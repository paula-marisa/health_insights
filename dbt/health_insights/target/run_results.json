{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-13T16:04:16.595569Z", "invocation_id": "b5054496-192e-4676-b78b-9c615654c244", "invocation_started_at": "2025-08-13T16:03:31.031995Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:12.843911Z", "completed_at": "2025-08-13T16:04:12.846083Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:12.864640Z", "completed_at": "2025-08-13T16:04:12.864671Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.054033517837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.health_insights.ref_municipios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:12.884293Z", "completed_at": "2025-08-13T16:04:12.915166Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:12.917031Z", "completed_at": "2025-08-13T16:04:12.917054Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.045053958892822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_ref_municipios_municipio_code.36fb7df381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom HEALTH_INSIGHTS.RAW_STG_RAW_STG.ref_municipios\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:12.896030Z", "completed_at": "2025-08-13T16:04:12.918538Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:12.921530Z", "completed_at": "2025-08-13T16:04:12.921551Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04674649238586426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_ref_municipios_municipio_code.f1ab57dc22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipio_code as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_RAW_STG.ref_municipios\nwhere municipio_code is not null\ngroup by municipio_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:12.819427Z", "completed_at": "2025-08-13T16:04:13.459086Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.461863Z", "completed_at": "2025-08-13T16:04:13.461886Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6557798385620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.stg_births", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nwith src as (\n  select * from HEALTH_INSIGHTS.RAW_STG.sinasc_raw\n),\n\nk as (\n  \n  \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n\n  select\n    s.*,\n    row_number() over (\n      order by \n  \n    cast(DTNASC as varchar)\n  \n, \n  \n    cast(HORANASC as varchar)\n  \n, \n  \n    cast(CODESTAB as varchar)\n  \n, \n  \n    cast(CODMUNNASC as varchar)\n  \n, \n  \n    cast(SEXO as varchar)\n  \n, \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n, \n  \n    cast(DTRECEBIM as varchar)\n  \n, \n  \n    cast(DTCADASTRO as varchar)\n  \n, \n  \n    cast(NUMEROLOTE as varchar)\n  \n, \n  \n    cast(CONTADOR as varchar)\n  \n\n    ) as rn\n  from src s\n),\n\nnorm as (\n  select\n    -- usa CONTADOR/CODMUNNASC se existirem; caso contr\u00e1rio usa NULL para estabilizar o hash\n    md5(\n      coalesce( \n  \n    cast(CONTADOR as varchar)\n  \n , '') || '-' ||\n      coalesce( \n  \n    cast(CODMUNNASC as varchar)\n  \n , '') || '-' ||\n      lpad(\n  \n    cast(rn as varchar)\n  \n, 10, '0')\n    ) as sk_birth,\n\n    -- data de nascimento: v\u00e1rias formas\n    case\n      when \n  \n    regexp_like(\n  \n    cast(DTNASC as varchar)\n  \n, '^[0-9]{4}-[0-9]{2}-[0-9]{2}$')\n  \n then\n        \n  \n    \n      try_to_date(\n  \n    cast(DTNASC as varchar)\n  \n)\n    \n  \n\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{8}$')\n  \n then\n        coalesce(\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'DDMMYYYY')\n    \n  \n,\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'YYYYMMDD')\n    \n  \n\n        )\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{7}$')\n  \n then\n        \n  \n    \n      try_to_date(lpad(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 8, '0'), 'DDMMYYYY')\n    \n  \n\n      else null\n    end as birth_date,\n\n    case \n  \n    cast(SEXO as varchar)\n  \n\n      when '1' then 'M'\n      when '2' then 'F'\n      else 'U'\n    end as sex_newborn,\n\n             \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n        as birth_weight_g,\n         \n  \n    cast(GESTACAO as varchar)\n  \n    as gestation_code,\n       \n  -- int funciona em Snowflake e Spark\n  cast(SEMAGESTAC as int)\n  as gestational_weeks,\n            \n  \n    cast(PARTO as varchar)\n  \n       as delivery_type,\n       \n  \n    cast(CODMUNNASC as varchar)\n  \n  as municipality_code\n  from k\n)\n\nselect\n  sk_birth, birth_date, sex_newborn, birth_weight_g,\n  gestation_code, gestational_weeks, delivery_type, municipality_code,\n  \n  \n    to_char(birth_date, 'YYYY-MM')\n  \n as ym\nfrom norm\nwhere birth_date is not null", "relation_name": "HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.507832Z", "completed_at": "2025-08-13T16:04:13.531302Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.534050Z", "completed_at": "2025-08-13T16:04:13.534066Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05420184135437012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_stg_births_birth_date.6972dfbab3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect birth_date\nfrom HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births\nwhere birth_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.493923Z", "completed_at": "2025-08-13T16:04:13.532105Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.536416Z", "completed_at": "2025-08-13T16:04:13.536430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06611490249633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.int_births_enriched", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT * FROM HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births\n)\nSELECT\n  s.sk_birth,\n  s.municipality_code,\n\n  s.birth_date,\n  \n  \n    \n      try_to_date(concat(s.ym, '-01'))\n    \n  \n AS year_month_date,  -- YYYY-MM-01\n  s.ym,\n\n  s.sex_newborn,\n  s.birth_weight_g,\n  s.gestation_code,\n  s.gestational_weeks,\n  s.delivery_type,\n\n  substr(cast(s.municipality_code as string), 1, 2) AS state_code,\n\n  CASE\n    WHEN s.birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN s.birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN s.birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END AS birth_weight_category,\n\n  CASE\n    WHEN s.gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN s.gestational_weeks < 37    THEN 'pre_termo'\n    WHEN s.gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN s.gestational_weeks >= 42   THEN 'pos_termo'\n  END AS gestation_category\nFROM s", "relation_name": "HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.500746Z", "completed_at": "2025-08-13T16:04:13.532657Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.538365Z", "completed_at": "2025-08-13T16:04:13.538376Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06117534637451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_stg_births_sex_newborn__M__F__U.37e37a471e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.514711Z", "completed_at": "2025-08-13T16:04:13.534953Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.541830Z", "completed_at": "2025-08-13T16:04:13.541842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059502601623535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_stg_births_sk_birth.3de4ffc9db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.565793Z", "completed_at": "2025-08-13T16:04:13.592543Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.596026Z", "completed_at": "2025-08-13T16:04:13.596044Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.046395063400268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_faixa_etaria_sexo", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT DISTINCT\n    sex_newborn\n  FROM HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n)\nSELECT\n  md5(coalesce(sex_newborn,'') || '|desconhecido') AS sk_faixa_etaria_sexo,\n  'desconhecido'                                   AS faixa_etaria_mae,\n  sex_newborn                                      AS sexo_bebe\nFROM s", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.dim_faixa_etaria_sexo", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.559162Z", "completed_at": "2025-08-13T16:04:13.594253Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.598545Z", "completed_at": "2025-08-13T16:04:13.598558Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05176997184753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_stg_births_sk_birth.744376c997", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_raw_stg.stg_births\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.571903Z", "completed_at": "2025-08-13T16:04:13.594931Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.600966Z", "completed_at": "2025-08-13T16:04:13.600984Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04960203170776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_localidade", "compiled": true, "compiled_code": "\n\nwith muni as (\n  select distinct municipality_code::string as municipio_code\n  from HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n  where municipality_code is not null\n),\nref as (\n  select\n    MUNICIPIO_CODE::string as municipio_code,\n    MUNICIPIO_NOME::string as municipio_nome,\n    UF_SIGLA::string       as uf_sigla,\n    REGIAO::string         as regiao\n  from HEALTH_INSIGHTS.RAW_STG_RAW_STG.ref_municipios\n)\nselect\n  md5(m.municipio_code)        as sk_localidade,\n  m.municipio_code,\n  coalesce(r.municipio_nome, 'desconhecido') as municipio_nome,\n  coalesce(r.uf_sigla, substr(m.municipio_code,1,2)) as uf_sigla,\n  coalesce(r.regiao, 'desconhecida') as regiao\nfrom muni m\nleft join ref r on r.municipio_code = m.municipio_code", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.578205Z", "completed_at": "2025-08-13T16:04:13.597347Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.605469Z", "completed_at": "2025-08-13T16:04:13.605485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05079817771911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_mae", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    municipality_code,\n    ym\n  FROM HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n)\nSELECT\n  md5(coalesce(municipality_code::string,'') || '|' || coalesce(ym,'')) AS sk_mae,\n  CAST(NULL AS NUMBER)                                                  AS idade_mae,\n  'desconhecido'                                                        AS faixa_etaria_mae,\n  'desconhecido'                                                        AS escolaridade_mae\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.dim_mae", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.629460Z", "completed_at": "2025-08-13T16:04:13.667123Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.670957Z", "completed_at": "2025-08-13T16:04:13.670974Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.058864593505859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_recem_nascido", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks\n  FROM HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n)\nSELECT\n  md5(\n    coalesce(sex_newborn,'') || '|' ||\n    coalesce(\n      CASE\n        WHEN birth_weight_g IS NULL THEN 'desconhecido'\n        WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n        WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n        ELSE 'adequado'\n      END, ''\n    ) || '|' ||\n    coalesce(\n      CASE\n        WHEN gestational_weeks IS NULL THEN 'desconhecido'\n        WHEN gestational_weeks < 37    THEN 'pre_termo'\n        WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n        WHEN gestational_weeks >= 42   THEN 'pos_termo'\n      END, ''\n    )\n  )                                    AS sk_recem_nascido,\n  sex_newborn                           AS sexo_bebe,\n  CASE\n    WHEN birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END                                   AS categoria_peso,\n  CASE\n    WHEN gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN gestational_weeks < 37    THEN 'pre_termo'\n    WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN gestational_weeks >= 42   THEN 'pos_termo'\n  END                                   AS categoria_gestacao\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.645720Z", "completed_at": "2025-08-13T16:04:13.669238Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.673820Z", "completed_at": "2025-08-13T16:04:13.673844Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05513763427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_faixa_etaria_mae__desconhecido.c2da527898", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_faixa_etaria_sexo\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.636036Z", "completed_at": "2025-08-13T16:04:13.670033Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.676187Z", "completed_at": "2025-08-13T16:04:13.676205Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.059827566146850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_tempo", "compiled": true, "compiled_code": "\n\nwith d as (\n  select distinct \n  \n    cast(birth_date as date)\n  \n as data\n  from HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n  where birth_date is not null\n)\nselect\n  md5(\n  \n    to_char(data, 'YYYY-MM-DD')\n  \n)      as sk_tempo,\n  data                                as data_dia,\n  year(data)                          as ano,\n  month(data)                         as mes,\n  \n  \n    to_char(data, 'YYYY-MM')\n  \n             as ym,\n  quarter(data)                       as trimestre,\n  \n  \n    dayofweekiso(data)\n  \n             as dia_semana_iso,\n  case when \n  \n    dayofweekiso(data)\n  \n in (6,7) then 1 else 0 end as is_fim_semana\nfrom d", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.653778Z", "completed_at": "2025-08-13T16:04:13.671978Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.680336Z", "completed_at": "2025-08-13T16:04:13.680352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05740785598754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_sexo_bebe__M__F__U.362c430907", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_faixa_etaria_sexo\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.700599Z", "completed_at": "2025-08-13T16:04:13.734824Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.737194Z", "completed_at": "2025-08-13T16:04:13.737209Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05092310905456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.852c7b558e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_faixa_etaria_sexo\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.713987Z", "completed_at": "2025-08-13T16:04:13.736359Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.740388Z", "completed_at": "2025-08-13T16:04:13.740401Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04827070236206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_municipio_code.a3a2fe0ea9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.720307Z", "completed_at": "2025-08-13T16:04:13.738546Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.743925Z", "completed_at": "2025-08-13T16:04:13.743935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04850435256958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_sk_localidade.4e64780a4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_localidade\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade\nwhere sk_localidade is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.707605Z", "completed_at": "2025-08-13T16:04:13.739059Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.745615Z", "completed_at": "2025-08-13T16:04:13.745625Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05529332160949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.b936648aef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_faixa_etaria_sexo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is not null\ngroup by sk_faixa_etaria_sexo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.762145Z", "completed_at": "2025-08-13T16:04:13.791830Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.797147Z", "completed_at": "2025-08-13T16:04:13.797162Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.048497915267944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_localidade_sk_localidade.9a9ecd5e89", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_localidade as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade\nwhere sk_localidade is not null\ngroup by sk_localidade\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.769866Z", "completed_at": "2025-08-13T16:04:13.805495Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.814517Z", "completed_at": "2025-08-13T16:04:13.814531Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06065797805786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_mae_faixa_etaria_mae__desconhecido.d11e899e97", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_mae\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.777174Z", "completed_at": "2025-08-13T16:04:13.806387Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.816469Z", "completed_at": "2025-08-13T16:04:13.816481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05901598930358887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_mae_sk_mae.c687c74418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_mae\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_mae\nwhere sk_mae is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.785226Z", "completed_at": "2025-08-13T16:04:13.812340Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.818657Z", "completed_at": "2025-08-13T16:04:13.818669Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05959439277648926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_mae_sk_mae.ba5d0f9bdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_mae as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_mae\nwhere sk_mae is not null\ngroup by sk_mae\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.807002Z", "completed_at": "2025-08-13T16:04:13.837462Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.846621Z", "completed_at": "2025-08-13T16:04:13.846632Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.045601844787597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_gestacao__pre_termo__termo__pos_termo__desconhecido.1c35f10411", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_gestacao as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\n    group by categoria_gestacao\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pre_termo','termo','pos_termo','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.841794Z", "completed_at": "2025-08-13T16:04:13.875038Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.878886Z", "completed_at": "2025-08-13T16:04:13.878902Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0501408576965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_peso__baixo_peso__adequado__macrossomico__desconhecido.5ffeee162e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_peso as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\n    group by categoria_peso\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'baixo_peso','adequado','macrossomico','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.848365Z", "completed_at": "2025-08-13T16:04:13.875579Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.881077Z", "completed_at": "2025-08-13T16:04:13.881088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04996228218078613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_sexo_bebe__M__F__U.5134deaa4d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.854024Z", "completed_at": "2025-08-13T16:04:13.877514Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.883080Z", "completed_at": "2025-08-13T16:04:13.883094Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0493626594543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_recem_nascido_sk_recem_nascido.ad02f86bcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_recem_nascido\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\nwhere sk_recem_nascido is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.870200Z", "completed_at": "2025-08-13T16:04:13.891052Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.896241Z", "completed_at": "2025-08-13T16:04:13.896272Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029860496520996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_recem_nascido_sk_recem_nascido.91c6374a3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_recem_nascido as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\nwhere sk_recem_nascido is not null\ngroup by sk_recem_nascido\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.913848Z", "completed_at": "2025-08-13T16:04:13.942946Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.946116Z", "completed_at": "2025-08-13T16:04:13.946155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05303382873535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_tempo_data_dia.fe310f51fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_dia\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo\nwhere data_dia is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.920131Z", "completed_at": "2025-08-13T16:04:13.943771Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.948936Z", "completed_at": "2025-08-13T16:04:13.948955Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05444836616516113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_tempo_sk_tempo.a5f54edc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_tempo\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo\nwhere sk_tempo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.905319Z", "completed_at": "2025-08-13T16:04:13.944393Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.951848Z", "completed_at": "2025-08-13T16:04:13.951875Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06045222282409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.fato_nascimentos", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    sk_birth,\n    birth_date,\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks,\n    municipality_code,\n    -- categorias alinhadas com a dim_recem_nascido\n    case\n      when birth_weight_g is null then 'desconhecido'\n      when birth_weight_g < 2500   then 'baixo_peso'\n      when birth_weight_g >= 4000  then 'macrossomico'\n      else 'adequado'\n    end as categoria_peso,\n    case\n      when gestational_weeks is null then 'desconhecido'\n      when gestational_weeks < 37    then 'pre_termo'\n      when gestational_weeks between 37 and 41 then 'termo'\n      when gestational_weeks >= 42   then 'pos_termo'\n    end as categoria_gestacao\n  from HEALTH_INSIGHTS.RAW_STG_silver.int_births_enriched\n  \n    -- janela incremental baseada na data (\u00faltima data j\u00e1 carregada)\n    where birth_date >= (\n      select coalesce(max(t.data_dia),'1900-01-01'::date)\n      from HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos f\n      join HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo t on f.fk_sk_tempo = t.sk_tempo\n    )\n  \n),\n\nlk_tempo as (\n  select sk_tempo, data_dia\n  from HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo\n),\n\nlk_localidade as (\n  -- aten\u00e7\u00e3o: na tua dimens\u00e3o o campo chama-se municipio_code (pt),\n  -- no int chama-se municipality_code (en)\n  select sk_localidade, municipio_code\n  from HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade\n),\n\nlk_recem as (\n  select sk_recem_nascido, sexo_bebe, categoria_peso, categoria_gestacao\n  from HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\n)\n\nselect\n  s.sk_birth,\n  t.sk_tempo              as fk_sk_tempo,\n  dloc.sk_localidade      as fk_sk_localidade,\n  drec.sk_recem_nascido   as fk_sk_recem_nascido,\n  s.sex_newborn\nfrom src s\nleft join lk_tempo      t    on s.birth_date = t.data_dia\nleft join lk_localidade dloc on s.municipality_code = dloc.municipio_code\nleft join lk_recem      drec\n       on drec.sexo_bebe = s.sex_newborn\n      and drec.categoria_peso = s.categoria_peso\n      and drec.categoria_gestacao = s.categoria_gestacao", "relation_name": "HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.935797Z", "completed_at": "2025-08-13T16:04:13.950256Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:13.957143Z", "completed_at": "2025-08-13T16:04:13.957156Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02990865707397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_tempo_sk_tempo.2def1c13e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_tempo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo\nwhere sk_tempo is not null\ngroup by sk_tempo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.978683Z", "completed_at": "2025-08-13T16:04:14.012370Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.014889Z", "completed_at": "2025-08-13T16:04:14.014906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.050464630126953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_fato_nascimentos_sex_newborn__M__F__U.4111c16aa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.996033Z", "completed_at": "2025-08-13T16:04:14.013337Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.018552Z", "completed_at": "2025-08-13T16:04:14.018564Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0488741397857666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_recem_nascido__sk_recem_nascido__ref_dim_recem_nascido_.4bc6e8e0f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_recem_nascido as from_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\n    where fk_sk_recem_nascido is not null\n),\n\nparent as (\n    select sk_recem_nascido as to_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_recem_nascido\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.989196Z", "completed_at": "2025-08-13T16:04:14.016483Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.022872Z", "completed_at": "2025-08-13T16:04:14.022885Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05499386787414551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_localidade__sk_localidade__ref_dim_localidade_.cee28b6216", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_localidade as from_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\n    where fk_sk_localidade is not null\n),\n\nparent as (\n    select sk_localidade as to_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_localidade\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:13.983898Z", "completed_at": "2025-08-13T16:04:14.017343Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.025154Z", "completed_at": "2025-08-13T16:04:14.025173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05895280838012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_fato_nascimentos_sk_birth.e98a446ce9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:14.046024Z", "completed_at": "2025-08-13T16:04:14.060550Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.062512Z", "completed_at": "2025-08-13T16:04:14.062531Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02817392349243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_fato_nascimentos_sk_birth.987afa4974", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-13T16:04:14.039469Z", "completed_at": "2025-08-13T16:04:14.063461Z"}, {"name": "execute", "started_at": "2025-08-13T16:04:14.065998Z", "completed_at": "2025-08-13T16:04:14.066010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03613853454589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_tempo__sk_tempo__ref_dim_tempo_.c417b97fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_tempo as from_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.fato_nascimentos\n    where fk_sk_tempo is not null\n),\n\nparent as (\n    select sk_tempo as to_field\n    from HEALTH_INSIGHTS.RAW_STG_marts.dim_tempo\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 9.763226747512817, "args": {"exclude": [], "state_modified_compare_more_unrendered_values": false, "macro_debugging": false, "vars": {}, "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "log_file_max_bytes": 10485760, "strict_mode": false, "empty_catalog": false, "static": false, "profiles_dir": "/home/paula/.dbt", "send_anonymous_usage_stats": true, "log_level_file": "debug", "log_path": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights/logs", "populate_cache": true, "project_dir": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights", "show_all_deprecations": false, "validate_macro_args": false, "require_nested_cumulative_type_params": false, "log_level": "info", "require_all_warnings_handled_by_warn_error": false, "select": [], "printer_width": 80, "introspect": true, "show_resource_report": false, "partial_parse_file_diff": true, "upload_to_artifacts_ingest_api": false, "use_colors": true, "use_fast_test_edges": false, "static_parser": true, "log_format_file": "debug", "require_generic_test_arguments_property": false, "use_colors_file": true, "require_yaml_configuration_for_mf_time_spines": false, "invocation_command": "dbt docs generate", "partial_parse": true, "state_modified_compare_vars": false, "write_json": true, "skip_nodes_if_on_run_start_fails": false, "which": "generate", "indirect_selection": "eager", "version_check": true, "compile": true, "require_resource_names_without_spaces": true, "log_format": "default", "defer": false, "quiet": false, "favor_state": false}}