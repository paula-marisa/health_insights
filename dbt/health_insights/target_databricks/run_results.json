{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-14T17:19:59.524309Z", "invocation_id": "27d8600d-e648-4542-989d-85f1c1971ec4", "invocation_started_at": "2025-08-14T17:18:30.117468Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:08.924783Z", "completed_at": "2025-08-14T17:19:08.924792Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:08.947056Z", "completed_at": "2025-08-14T17:19:13.140105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.263636827468872, "adapter_response": {"_message": "INSERT 27", "code": "INSERT", "rows_affected": 27}, "message": "INSERT 27", "failures": null, "unique_id": "seed.health_insights.ref_uf", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:08.923105Z", "completed_at": "2025-08-14T17:19:08.923115Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:08.929170Z", "completed_at": "2025-08-14T17:19:13.336075Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.461535692214966, "adapter_response": {"_message": "INSERT 10", "code": "INSERT", "rows_affected": 10}, "message": "INSERT 10", "failures": null, "unique_id": "seed.health_insights.ref_municipios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:13.165536Z", "completed_at": "2025-08-14T17:19:13.189089Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:13.190387Z", "completed_at": "2025-08-14T17:19:13.841066Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6807084083557129, "adapter_response": {"_message": "OK", "query_id": "01f07932-ccda-1438-94df-6f1a4ca77998"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_uf_uf_sigla.28d0cf764d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect uf_sigla\nfrom `health_insights`.`raw_stg_marts`.`ref_uf`\nwhere uf_sigla is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:13.359885Z", "completed_at": "2025-08-14T17:19:13.383194Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:13.384527Z", "completed_at": "2025-08-14T17:19:15.008313Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6570801734924316, "adapter_response": {"_message": "OK", "query_id": "01f07932-ccf6-156b-9349-373bcfe04f3f"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_uf_uf_sigla.f1ac44888d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    uf_sigla as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg_marts`.`ref_uf`\nwhere uf_sigla is not null\ngroup by uf_sigla\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:13.860386Z", "completed_at": "2025-08-14T17:19:13.880334Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:13.881789Z", "completed_at": "2025-08-14T17:19:15.011010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.157761573791504, "adapter_response": {"_message": "OK", "query_id": "01f07932-cd47-113f-b981-9d96dce381c7"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_municipios_municipio_code.36fb7df381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom `health_insights`.`raw_stg_marts`.`ref_municipios`\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:08.891607Z", "completed_at": "2025-08-14T17:19:08.954077Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:08.956033Z", "completed_at": "2025-08-14T17:19:15.016909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.146534442901611, "adapter_response": {"_message": "OK", "query_id": "01f07932-cbca-1457-b2e8-2346b829a014"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.check_conn", "compiled": true, "compiled_code": "\nselect current_user() as user_name, current_catalog() as catalog_name,\n       current_schema() as schema_name, current_timestamp() as ts", "relation_name": "`health_insights`.`raw_stg`.`check_conn`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:15.049148Z", "completed_at": "2025-08-14T17:19:15.069566Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:15.071298Z", "completed_at": "2025-08-14T17:19:16.167725Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1279776096343994, "adapter_response": {"_message": "OK", "query_id": "01f07932-ce00-1fd9-b160-bd8b07597982"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_municipios_municipio_code.f1ab57dc22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipio_code as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg_marts`.`ref_municipios`\nwhere municipio_code is not null\ngroup by municipio_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:08.903070Z", "completed_at": "2025-08-14T17:19:10.374924Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:10.376461Z", "completed_at": "2025-08-14T17:19:16.677357Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 7.804860353469849, "adapter_response": {"_message": "OK", "query_id": "01f07932-ceaa-1396-af96-e27e5fe30de3"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.stg_births", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nwith src as (\n  select * from `health_insights`.`raw_stg`.`sinasc_raw`\n),\n\nk as (\n  \n  \n  \n    \n      \n        \n      \n    \n  \n    \n  \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  select\n    s.*,\n    row_number() over (\n      order by \n  \n    cast(DTNASC as string)\n  \n, \n  \n    cast(CODMUNNASC as string)\n  \n, \n  \n    cast(SEXO as string)\n  \n, \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n\n    ) as rn\n  from src s\n),\n\nnorm as (\n  select\n    -- usa CONTADOR/CODMUNNASC se existirem; caso contr\u00e1rio usa NULL para estabilizar o hash\n    md5(\n      coalesce( cast(null as string) , '') || '-' ||\n      coalesce( \n  \n    cast(CODMUNNASC as string)\n  \n , '') || '-' ||\n      lpad(\n  \n    cast(rn as string)\n  \n, 10, '0')\n    ) as sk_birth,\n\n    -- data de nascimento: v\u00e1rias formas\n    case\n      when \n  \n    (\n  \n    cast(DTNASC as string)\n  \n rlike '^[0-9]{4}-[0-9]{2}-[0-9]{2}$')\n  \n then\n        \n  \n    \n      to_date(\n  \n    cast(DTNASC as string)\n  \n)\n    \n  \n\n      when \n  \n    (regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]','') rlike '^[0-9]{8}$')\n  \n then\n        coalesce(\n          \n  \n    \n      to_date(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 'ddmmyyyy')\n    \n  \n,\n          \n  \n    \n      to_date(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 'yyyymmdd')\n    \n  \n\n        )\n      when \n  \n    (regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]','') rlike '^[0-9]{7}$')\n  \n then\n        \n  \n    \n      to_date(lpad(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 8, '0'), 'ddmmyyyy')\n    \n  \n\n      else null\n    end as birth_date,\n\n    case \n  \n    cast(SEXO as string)\n  \n\n      when '1' then 'M'\n      when '2' then 'F'\n      else 'U'\n    end as sex_newborn,\n\n             \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n        as birth_weight_g,\n         \n  \n    cast(GESTACAO as string)\n  \n    as gestation_code,\n       \n  -- int funciona em Snowflake e Spark\n  cast(SEMAGESTAC as int)\n  as gestational_weeks,\n     cast(null as string)  as delivery_type,\n       \n  \n    cast(CODMUNNASC as string)\n  \n  as municipality_code\n  from k\n)\n\nselect\n  sk_birth, birth_date, sex_newborn, birth_weight_g,\n  gestation_code, gestational_weeks, delivery_type, municipality_code,\n  \n  \n    date_format(birth_date, 'yyyy-MM')\n  \n as ym\nfrom norm\nwhere birth_date is not null", "relation_name": "`health_insights`.`raw_stg`.`stg_births`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:16.722019Z", "completed_at": "2025-08-14T17:19:16.749818Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:16.755909Z", "completed_at": "2025-08-14T17:19:17.933938Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2370119094848633, "adapter_response": {"_message": "OK", "query_id": "01f07932-cf02-15ff-a1cb-18268f845e50"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_birth_date.6972dfbab3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect birth_date\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere birth_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:16.709978Z", "completed_at": "2025-08-14T17:19:16.741975Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:16.744204Z", "completed_at": "2025-08-14T17:19:17.939717Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.2448399066925049, "adapter_response": {"_message": "OK", "query_id": "01f07932-cf01-12d6-b91b-cc878a5e0f01"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_stg_births_sex_newborn__M__F__U.37e37a471e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`raw_stg`.`stg_births`\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:16.726981Z", "completed_at": "2025-08-14T17:19:16.742696Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:16.751029Z", "completed_at": "2025-08-14T17:19:17.942085Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.242929220199585, "adapter_response": {"_message": "OK", "query_id": "01f07932-cf03-137a-8ae4-ac2d64f1ad83"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_sk_birth.3de4ffc9db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:17.964504Z", "completed_at": "2025-08-14T17:19:17.985533Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:17.987490Z", "completed_at": "2025-08-14T17:19:19.201366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2421321868896484, "adapter_response": {"_message": "OK", "query_id": "01f07932-cfbd-1743-9986-92e79a969ebb"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_stg_births_sk_birth.744376c997", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:19.217939Z", "completed_at": "2025-08-14T17:19:19.231683Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:19.233040Z", "completed_at": "2025-08-14T17:19:19.776197Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5627429485321045, "adapter_response": {"_message": "OK", "query_id": "01f07932-d07c-19cc-b076-ec75b096dd05"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.int_births_enriched", "compiled": true, "compiled_code": "\n\nwith s as (\n  select * from `health_insights`.`raw_stg`.`stg_births`\n)\nselect\n  s.sk_birth,\n  s.municipality_code,\n  s.birth_date,\n  \n  \n    \n      to_date(concat(s.ym, '-01'))\n    \n  \n as year_month_date,\n  s.ym,\n\n  -- CAMPOS QUE A FATO PRECISA:\n  s.sex_newborn,\n  /* ajuste os nomes conforme existirem no teu stg_births */\n  s.birth_weight_g         as birth_weight_g,      -- se no stg for 'peso_nascimento_g', mapeia: s.peso_nascimento_g as birth_weight_g\n  s.gestational_weeks      as gestational_weeks,   -- idem ('semanas_gestacao' -> gestational_weeks)\n  s.delivery_type          as delivery_type,       -- idem ('tipo_parto' -> delivery_type)\n\n  -- outros campos \u00fateis\n  substr(cast(s.municipality_code as string), 1, 2) as state_code\nfrom s", "relation_name": "`health_insights`.`silver`.`int_births_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:16.183710Z", "completed_at": "2025-08-14T17:19:16.222746Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:16.224247Z", "completed_at": "2025-08-14T17:19:20.908885Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.731045961380005, "adapter_response": {"_message": "OK", "query_id": "01f07932-cfb8-1a9f-8cf1-62fa06f778e1"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.dim_localidade", "compiled": true, "compiled_code": "-- models/marts/dim/dim_localidade.sql\n\n\nwith muni as (\n  select\n    municipio_code,              -- vem do seed\n    uf_sigla       as state_code,\n    municipio_nome,\n    regiao\n  from `health_insights`.`raw_stg_marts`.`ref_municipios`\n),\nufs as (\n  select\n    uf_sigla as state_code,\n    uf_nome  as state_name\n  from `health_insights`.`raw_stg_marts`.`ref_uf`\n)\nselect\n  md5(cast(concat(coalesce(cast(m.municipio_code as string), '_dbt_utils_surrogate_key_null_')) as string)) as sk_localidade,\n  m.municipio_code  as municipality_code,\n  m.state_code,\n  u.state_name,\n  m.municipio_nome  as nome_municipio,\n  m.regiao\nfrom muni m\nleft join ufs u using (state_code)", "relation_name": "`health_insights`.`marts`.`dim_localidade`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:19.809015Z", "completed_at": "2025-08-14T17:19:19.837818Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:19.847324Z", "completed_at": "2025-08-14T17:19:24.567312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.776629447937012, "adapter_response": {"_message": "OK", "query_id": "01f07932-d1c1-196c-a2e3-1cb0a55f7701"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.dim_faixa_etaria_sexo", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT DISTINCT\n    sex_newborn\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  md5(coalesce(sex_newborn,'') || '|desconhecido') AS sk_faixa_etaria_sexo,\n  'desconhecido'                                   AS faixa_etaria_mae,\n  sex_newborn                                      AS sexo_bebe\nFROM s", "relation_name": "`health_insights`.`marts`.`dim_faixa_etaria_sexo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:19.820787Z", "completed_at": "2025-08-14T17:19:19.832459Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:19.834388Z", "completed_at": "2025-08-14T17:19:25.328005Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.532681465148926, "adapter_response": {"_message": "OK", "query_id": "01f07932-d1c0-1c11-be9d-b2babd8d07e9"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.dim_recem_nascido", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  md5(\n    coalesce(sex_newborn,'') || '|' ||\n    coalesce(\n      CASE\n        WHEN birth_weight_g IS NULL THEN 'desconhecido'\n        WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n        WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n        ELSE 'adequado'\n      END, ''\n    ) || '|' ||\n    coalesce(\n      CASE\n        WHEN gestational_weeks IS NULL THEN 'desconhecido'\n        WHEN gestational_weeks < 37    THEN 'pre_termo'\n        WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n        WHEN gestational_weeks >= 42   THEN 'pos_termo'\n      END, ''\n    )\n  )                                    AS sk_recem_nascido,\n  sex_newborn                           AS sexo_bebe,\n  CASE\n    WHEN birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END                                   AS categoria_peso,\n  CASE\n    WHEN gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN gestational_weeks < 37    THEN 'pre_termo'\n    WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN gestational_weeks >= 42   THEN 'pos_termo'\n  END                                   AS categoria_gestacao\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "`health_insights`.`marts`.`dim_recem_nascido`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:19.816052Z", "completed_at": "2025-08-14T17:19:19.837365Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:19.841170Z", "completed_at": "2025-08-14T17:19:25.331182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.538154363632202, "adapter_response": {"_message": "OK", "query_id": "01f07932-d1c8-13e1-b537-73bfce56ae25"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.dim_mae", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT municipality_code, ym\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  -- port\u00e1til entre Snowflake e Databricks\n  md5(cast(concat(coalesce(cast(municipality_code as string), '_dbt_utils_surrogate_key_null_'), '-', coalesce(cast(ym as string), '_dbt_utils_surrogate_key_null_')) as string)) AS sk_mae,\n  CAST(NULL AS INT)                                                  AS idade_mae,      -- <- era NUMBER\n  'desconhecido'                                                     AS faixa_etaria_mae,\n  'desconhecido'                                                     AS escolaridade_mae\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "`health_insights`.`marts`.`dim_mae`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:24.583731Z", "completed_at": "2025-08-14T17:19:24.604388Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:24.606165Z", "completed_at": "2025-08-14T17:19:25.389126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.811762809753418, "adapter_response": {"_message": "OK", "query_id": "01f07932-d3c3-15aa-853b-34d103a71a09"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_municipality_code.c333a34ef4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipality_code\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere municipality_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:25.366060Z", "completed_at": "2025-08-14T17:19:25.395713Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:25.398775Z", "completed_at": "2025-08-14T17:19:26.080129Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7282378673553467, "adapter_response": {"_message": "OK", "query_id": "01f07932-d43d-1b21-9ea8-22919f4e9f45"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_nome_municipio.308dae2d1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_municipio\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere nome_municipio is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:25.376852Z", "completed_at": "2025-08-14T17:19:25.396278Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:25.403215Z", "completed_at": "2025-08-14T17:19:26.372562Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0184788703918457, "adapter_response": {"_message": "OK", "query_id": "01f07932-d43d-15fa-8810-bc2d46eb9746"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_sk_localidade.4e64780a4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_localidade\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere sk_localidade is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:25.417567Z", "completed_at": "2025-08-14T17:19:25.440124Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:25.441810Z", "completed_at": "2025-08-14T17:19:26.374502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9653291702270508, "adapter_response": {"_message": "OK", "query_id": "01f07932-d441-1f1a-9c20-3be519c2c56e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_state_code.c73ddb8f97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:20.934953Z", "completed_at": "2025-08-14T17:19:20.966902Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:20.968613Z", "completed_at": "2025-08-14T17:19:26.370454Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.442707538604736, "adapter_response": {"_message": "OK", "query_id": "01f07932-d239-19f5-bd97-0383084551fb"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.dim_tempo", "compiled": true, "compiled_code": "\n\nwith d as (\n  select distinct \n  \n    cast(birth_date as date)\n  \n as data\n  from `health_insights`.`silver`.`int_births_enriched`\n  where birth_date is not null\n)\nselect\n  md5(\n  \n    date_format(data, 'yyyy-MM-dd')\n  \n)      as sk_tempo,\n  data                                as data_dia,\n  year(data)                          as ano,\n  month(data)                         as mes,\n  \n  \n    date_format(data, 'yyyy-MM')\n  \n             as ym,\n  quarter(data)                       as trimestre,\n  \n  \n    -- dayofweek: Dom=1 .. Sab=7 \u2192 converter para ISO (Seg=1 .. Dom=7)\n    (((dayofweek(data) + 5) % 7) + 1)\n  \n             as dia_semana_iso,\n  case when \n  \n    -- dayofweek: Dom=1 .. Sab=7 \u2192 converter para ISO (Seg=1 .. Dom=7)\n    (((dayofweek(data) + 5) % 7) + 1)\n  \n in (6,7) then 1 else 0 end as is_fim_semana\nfrom d", "relation_name": "`health_insights`.`marts`.`dim_tempo`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:26.093930Z", "completed_at": "2025-08-14T17:19:26.117234Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:26.119285Z", "completed_at": "2025-08-14T17:19:27.896121Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.808319330215454, "adapter_response": {"_message": "OK", "query_id": "01f07932-d4af-1e6b-b467-1462f1f5f78e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_municipality_code.fc817a75fb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipality_code as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere municipality_code is not null\ngroup by municipality_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:26.420910Z", "completed_at": "2025-08-14T17:19:26.436315Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:26.441660Z", "completed_at": "2025-08-14T17:19:28.203076Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8060083389282227, "adapter_response": {"_message": "OK", "query_id": "01f07932-d4dc-1530-b45f-8da56580e57b"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_sexo_bebe__M__F__U.362c430907", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_faixa_etaria_sexo`\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:26.413979Z", "completed_at": "2025-08-14T17:19:26.440598Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:26.446449Z", "completed_at": "2025-08-14T17:19:28.254539Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8589684963226318, "adapter_response": {"_message": "OK", "query_id": "01f07932-d4db-1ea5-98ec-a6b8201fda4a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_faixa_etaria_mae__desconhecido.c2da527898", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_faixa_etaria_sexo`\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:26.406794Z", "completed_at": "2025-08-14T17:19:26.435077Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:26.437199Z", "completed_at": "2025-08-14T17:19:28.381753Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.98787260055542, "adapter_response": {"_message": "OK", "query_id": "01f07932-d4db-1806-bc45-35c7581d29a3"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_sk_localidade.9a9ecd5e89", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_localidade as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere sk_localidade is not null\ngroup by sk_localidade\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:27.909508Z", "completed_at": "2025-08-14T17:19:27.930297Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:27.932296Z", "completed_at": "2025-08-14T17:19:29.441931Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5381319522857666, "adapter_response": {"_message": "OK", "query_id": "01f07932-d534-17aa-8e1a-8fbb03862040"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.852c7b558e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_faixa_etaria_sexo\nfrom `health_insights`.`marts`.`dim_faixa_etaria_sexo`\nwhere sk_faixa_etaria_sexo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:28.214383Z", "completed_at": "2025-08-14T17:19:28.236272Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:28.237711Z", "completed_at": "2025-08-14T17:19:29.444513Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2350997924804688, "adapter_response": {"_message": "OK", "query_id": "01f07932-d563-1769-8c08-90ab3bf709d9"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.b936648aef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_faixa_etaria_sexo as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_faixa_etaria_sexo`\nwhere sk_faixa_etaria_sexo is not null\ngroup by sk_faixa_etaria_sexo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:28.397903Z", "completed_at": "2025-08-14T17:19:28.418995Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:28.420695Z", "completed_at": "2025-08-14T17:19:29.447145Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0560717582702637, "adapter_response": {"_message": "OK", "query_id": "01f07932-d57f-13e6-87e1-0a22f01dcce8"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_peso__baixo_peso__adequado__macrossomico__desconhecido.5ffeee162e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_peso as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by categoria_peso\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'baixo_peso','adequado','macrossomico','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:28.269898Z", "completed_at": "2025-08-14T17:19:28.290395Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:28.291824Z", "completed_at": "2025-08-14T17:19:29.449560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1859443187713623, "adapter_response": {"_message": "OK", "query_id": "01f07932-d56c-166d-94e1-e3931953ae4d"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_gestacao__pre_termo__termo__pos_termo__desconhecido.1c35f10411", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_gestacao as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by categoria_gestacao\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pre_termo','termo','pos_termo','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:29.510467Z", "completed_at": "2025-08-14T17:19:29.542945Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:29.551224Z", "completed_at": "2025-08-14T17:19:30.381466Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9007129669189453, "adapter_response": {"_message": "OK", "query_id": "01f07932-d631-1ec4-a5e5-d2781fe8ce25"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_recem_nascido_sk_recem_nascido.ad02f86bcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_recem_nascido\nfrom `health_insights`.`marts`.`dim_recem_nascido`\nwhere sk_recem_nascido is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:29.521670Z", "completed_at": "2025-08-14T17:19:29.536847Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:29.544949Z", "completed_at": "2025-08-14T17:19:30.384426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8987665176391602, "adapter_response": {"_message": "OK", "query_id": "01f07932-d631-1d9b-9ae8-027aa8acc331"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_mae_faixa_etaria_mae__desconhecido.d11e899e97", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_mae`\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:29.503483Z", "completed_at": "2025-08-14T17:19:29.535766Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:29.538702Z", "completed_at": "2025-08-14T17:19:30.387006Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9081170558929443, "adapter_response": {"_message": "OK", "query_id": "01f07932-d631-13fc-bdac-14523844f4e2"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_sexo_bebe__M__F__U.5134deaa4d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:29.516214Z", "completed_at": "2025-08-14T17:19:29.543664Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:29.556819Z", "completed_at": "2025-08-14T17:19:30.427890Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9446642398834229, "adapter_response": {"_message": "OK", "query_id": "01f07932-d633-161f-8bc0-80cc2ed46c81"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_recem_nascido_sk_recem_nascido.91c6374a3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_recem_nascido as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_recem_nascido`\nwhere sk_recem_nascido is not null\ngroup by sk_recem_nascido\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:30.436744Z", "completed_at": "2025-08-14T17:19:30.468212Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:30.471157Z", "completed_at": "2025-08-14T17:19:31.998353Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5864384174346924, "adapter_response": {"_message": "OK", "query_id": "01f07932-d6c2-126d-bbad-476663163a79"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_mae_sk_mae.c687c74418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_mae\nfrom `health_insights`.`marts`.`dim_mae`\nwhere sk_mae is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:30.476160Z", "completed_at": "2025-08-14T17:19:30.507752Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:30.514407Z", "completed_at": "2025-08-14T17:19:32.001239Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5370612144470215, "adapter_response": {"_message": "OK", "query_id": "01f07932-d6c7-1dfd-afa3-3577bf89da0e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_sk_tempo.a5f54edc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_tempo\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere sk_tempo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:30.449477Z", "completed_at": "2025-08-14T17:19:30.469389Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:30.481621Z", "completed_at": "2025-08-14T17:19:32.004307Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5886189937591553, "adapter_response": {"_message": "OK", "query_id": "01f07932-d6c3-11c3-8f7c-4e3bfee6b49b"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_data_dia.fe310f51fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_dia\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere data_dia is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:30.443131Z", "completed_at": "2025-08-14T17:19:30.474729Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:30.487324Z", "completed_at": "2025-08-14T17:19:32.007026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.593024492263794, "adapter_response": {"_message": "OK", "query_id": "01f07932-d6c4-106d-84ae-a13a5b544ff6"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_mae_sk_mae.ba5d0f9bdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_mae as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_mae`\nwhere sk_mae is not null\ngroup by sk_mae\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:32.045404Z", "completed_at": "2025-08-14T17:19:32.069799Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:32.072327Z", "completed_at": "2025-08-14T17:19:32.862163Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8306081295013428, "adapter_response": {"_message": "OK", "query_id": "01f07932-d7c4-1e8a-933f-28a6636d9a2d"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_tempo_sk_tempo.2def1c13e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_tempo as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere sk_tempo is not null\ngroup by sk_tempo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:32.053962Z", "completed_at": "2025-08-14T17:19:32.070904Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:32.077882Z", "completed_at": "2025-08-14T17:19:41.052140Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.018122911453247, "adapter_response": {"_message": "OK", "query_id": "01f07932-dabd-1b4f-8825-513c52bfb41d"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.fato_nascimentos_enriquecido", "compiled": true, "compiled_code": "-- models/marts/fato_nascimentos_enriquecido.sql\n\n\nwith f as (\n  select * from `health_insights`.`silver`.`int_births_enriched`\n)\nselect\n  f.*,\n  d.sk_localidade,\n  d.nome_municipio,\n  d.state_name\nfrom f\nleft join `health_insights`.`marts`.`dim_localidade` d\n  on d.municipality_code = f.municipality_code", "relation_name": "`health_insights`.`marts`.`fato_nascimentos_enriquecido`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:32.880636Z", "completed_at": "2025-08-14T17:19:32.909294Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:32.910749Z", "completed_at": "2025-08-14T17:19:47.031846Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 14.15824556350708, "adapter_response": {"_message": "OK", "query_id": "01f07932-dc10-1203-9e3f-279bbc81640a"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.fato_nascimentos", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    sk_birth,\n    birth_date,\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks,\n    delivery_type,\n    municipality_code,\n    -- categorias para link com dim_recem_nascido\n    case\n      when birth_weight_g is null then 'desconhecido'\n      when birth_weight_g < 2500   then 'baixo_peso'\n      when birth_weight_g >= 4000  then 'macrossomico'\n      else 'adequado'\n    end as categoria_peso,\n    case\n      when gestational_weeks is null then 'desconhecido'\n      when gestational_weeks < 37    then 'pre_termo'\n      when gestational_weeks between 37 and 41 then 'termo'\n      when gestational_weeks >= 42   then 'pos_termo'\n    end as categoria_gestacao\n  from `health_insights`.`silver`.`int_births_enriched`\n  \n    where birth_date >= (\n      select coalesce(max(t.data_dia),'1900-01-01'::date)\n      from `health_insights`.`marts`.`fato_nascimentos` f\n      join `health_insights`.`marts`.`dim_tempo` t on f.fk_sk_tempo = t.sk_tempo\n    )\n  \n),\n\nlk_tempo as (\n  select sk_tempo, data_dia\n  from `health_insights`.`marts`.`dim_tempo`\n),\n\nlk_localidade as (\n  select sk_localidade, municipality_code\n  from `health_insights`.`marts`.`dim_localidade`\n),\n\nlk_recem as (\n  select sk_recem_nascido, sexo_bebe, categoria_peso, categoria_gestacao\n  from `health_insights`.`marts`.`dim_recem_nascido`\n)\n\nselect\n  -- chaves\n  s.sk_birth,\n  t.sk_tempo            as fk_sk_tempo,\n  dloc.sk_localidade    as fk_sk_localidade,\n  drec.sk_recem_nascido as fk_sk_recem_nascido,\n\n  -- MEDIDAS / ATRIBUTOS para o dashboard\n  s.sex_newborn,\n  s.birth_weight_g,\n  s.gestational_weeks,\n  s.delivery_type\nfrom src s\nleft join lk_tempo      t    on s.birth_date = t.data_dia\nleft join lk_localidade dloc on s.municipality_code = dloc.municipality_code\nleft join lk_recem      drec\n       on drec.sexo_bebe = s.sex_newborn\n      and drec.categoria_peso = s.categoria_peso\n      and drec.categoria_gestacao = s.categoria_gestacao", "relation_name": "`health_insights`.`marts`.`fato_nascimentos`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:47.083481Z", "completed_at": "2025-08-14T17:19:47.124021Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:47.129973Z", "completed_at": "2025-08-14T17:19:47.794110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7401041984558105, "adapter_response": {"_message": "OK", "query_id": "01f07932-e10a-15de-993d-41b0db5fca0a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_fato_nascimentos_sk_birth.e98a446ce9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom `health_insights`.`marts`.`fato_nascimentos`\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:47.075268Z", "completed_at": "2025-08-14T17:19:47.122772Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:47.125110Z", "completed_at": "2025-08-14T17:19:48.552306Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.499908685684204, "adapter_response": {"_message": "OK", "query_id": "01f07932-e109-16f7-9064-137ba44fbac5"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_fato_nascimentos_sex_newborn__M__F__U.4111c16aa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`fato_nascimentos`\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:47.089414Z", "completed_at": "2025-08-14T17:19:47.124604Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:47.133259Z", "completed_at": "2025-08-14T17:19:48.554815Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4991445541381836, "adapter_response": {"_message": "OK", "query_id": "01f07932-e10a-105f-8b5e-46d791bcbc18"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_localidade__sk_localidade__ref_dim_localidade_.cee28b6216", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_localidade as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_localidade is not null\n),\n\nparent as (\n    select sk_localidade as to_field\n    from `health_insights`.`marts`.`dim_localidade`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:47.105127Z", "completed_at": "2025-08-14T17:19:47.128573Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:47.140414Z", "completed_at": "2025-08-14T17:19:48.557007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.499772548675537, "adapter_response": {"_message": "OK", "query_id": "01f07932-e10a-143a-8837-be21eb0eed08"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_recem_nascido__sk_recem_nascido__ref_dim_recem_nascido_.4bc6e8e0f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_recem_nascido as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_recem_nascido is not null\n),\n\nparent as (\n    select sk_recem_nascido as to_field\n    from `health_insights`.`marts`.`dim_recem_nascido`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:47.815804Z", "completed_at": "2025-08-14T17:19:47.837688Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:47.839128Z", "completed_at": "2025-08-14T17:19:49.186435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3788337707519531, "adapter_response": {"_message": "OK", "query_id": "01f07932-e174-1a81-9628-2ede5db80219"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_tempo__sk_tempo__ref_dim_tempo_.c417b97fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_tempo as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_tempo is not null\n),\n\nparent as (\n    select sk_tempo as to_field\n    from `health_insights`.`marts`.`dim_tempo`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:48.575608Z", "completed_at": "2025-08-14T17:19:48.595197Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:48.597216Z", "completed_at": "2025-08-14T17:19:50.029366Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4590013027191162, "adapter_response": {"_message": "OK", "query_id": "01f07932-e1e7-1976-8be7-cb5adb42e4ac"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_fato_nascimentos_sk_birth.987afa4974", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`fato_nascimentos`\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:50.086745Z", "completed_at": "2025-08-14T17:19:50.107219Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:50.121978Z", "completed_at": "2025-08-14T17:19:51.130123Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0776958465576172, "adapter_response": {"_message": "OK", "query_id": "01f07932-e2d3-14a7-967d-a36c1ebdfcb9"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.quality_metrics", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, data_dia\n  FROM `health_insights`.`marts`.`dim_tempo`\n)\nSELECT\n  t.data_dia AS birth_date,\n  \n  \n    date_format(t.data_dia, 'yyyy-MM')\n  \n AS ym,\n  COUNT(*) AS n_registos,\n  AVG(CASE WHEN f.birth_weight_g    IS NULL THEN 1 ELSE 0 END) AS pct_sem_peso,\n  AVG(CASE WHEN f.gestational_weeks IS NULL THEN 1 ELSE 0 END) AS pct_sem_gestacao\nFROM f\nLEFT JOIN t ON f.fk_sk_tempo = t.sk_tempo\nGROUP BY 1,2", "relation_name": "`health_insights`.`marts`.`quality_metrics`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:50.072682Z", "completed_at": "2025-08-14T17:19:50.102297Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:50.113756Z", "completed_at": "2025-08-14T17:19:55.401307Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.351991653442383, "adapter_response": {"_message": "OK", "query_id": "01f07932-e5b6-141e-92c3-74909fecbc5e"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.fed_kpis", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, \n  \n    date_format(data_dia, 'yyyy-MM')\n  \n AS ym\n  FROM `health_insights`.`marts`.`dim_tempo`\n)\nSELECT\n  t.ym,\n  COUNT(*) AS total_nascimentos,\n  AVG(CASE WHEN f.gestational_weeks IS NOT NULL AND f.gestational_weeks < 37 THEN 1 ELSE 0 END) AS pct_prematuros,\n  AVG(CASE WHEN f.birth_weight_g    IS NOT NULL AND f.birth_weight_g    < 2500 THEN 1 ELSE 0 END) AS pct_baixo_peso,\n  AVG(CASE WHEN UPPER(f.delivery_type) IN ('C','CESAREA','CES\u00c1REA','CESAREAN','CESARIANA') THEN 1 ELSE 0 END) AS pct_cesarianas\nFROM f\nJOIN t ON f.fk_sk_tempo = t.sk_tempo\nGROUP BY 1", "relation_name": "`health_insights`.`silver`.`fed_kpis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:50.067155Z", "completed_at": "2025-08-14T17:19:50.100203Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:50.103691Z", "completed_at": "2025-08-14T17:19:55.865701Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.818046808242798, "adapter_response": {"_message": "OK", "query_id": "01f07932-e611-1e61-9354-fba3d8427320"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.fed_fato", "compiled": true, "compiled_code": "\n\nwith f as (\n  select * from `health_insights`.`marts`.`fato_nascimentos`\n),\nt as (\n  select sk_tempo, data_dia, ano, mes from `health_insights`.`marts`.`dim_tempo`\n)\nselect\n  -- colunas necess\u00e1rias da fato\n  f.sk_birth,\n  f.fk_sk_tempo,\n  f.fk_sk_localidade,\n  f.birth_weight_g,\n  f.gestational_weeks,\n  f.delivery_type,\n\n  -- birth_date (compat\u00edvel)\n  \n    t.data_dia as birth_date,\n  \n\n  -- ym can\u00f3nico yyyy-MM\n  \n    lpad(cast(t.ano as string), 4, '0') || '-' || lpad(cast(t.mes as string), 2, '0') as ym\n  \nfrom f\nleft join t\n  on f.fk_sk_tempo = t.sk_tempo", "relation_name": "`health_insights`.`silver`.`fed_fato`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:19:50.081536Z", "completed_at": "2025-08-14T17:19:50.101387Z"}, {"name": "execute", "started_at": "2025-08-14T17:19:50.108492Z", "completed_at": "2025-08-14T17:19:55.868488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.817504405975342, "adapter_response": {"_message": "OK", "query_id": "01f07932-e612-1659-8aaa-9ed2c56a2e58"}, "message": "OK", "failures": null, "unique_id": "model.health_insights.kpis_mensais", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, \n  \n    date_format(data_dia, 'yyyy-MM')\n  \n AS ym\n  FROM `health_insights`.`marts`.`dim_tempo`\n),\nl AS (\n  SELECT sk_localidade, state_code, state_name\n  FROM `health_insights`.`marts`.`dim_localidade`\n)\nSELECT\n  t.ym,\n  l.state_code,\n  COUNT(*) AS total_nascimentos,\n  AVG(CASE WHEN UPPER(f.delivery_type) IN ('C','CESAREA','CES\u00c1REA') THEN 1 ELSE 0 END) AS pct_cesarianas\nFROM f\nJOIN t ON f.fk_sk_tempo = t.sk_tempo\nJOIN l ON f.fk_sk_localidade = l.sk_localidade\nGROUP BY 1,2", "relation_name": "`health_insights`.`marts`.`kpis_mensais`", "batch_results": null}], "elapsed_time": 55.41541147232056, "args": {"log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "invocation_command": "dbt build --target databricks --target-path target_databricks", "project_dir": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights", "resource_types": [], "version_check": true, "log_level_file": "debug", "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "vars": {}, "require_generic_test_arguments_property": false, "state_modified_compare_vars": false, "which": "build", "defer": false, "export_saved_queries": false, "require_batched_execution_for_custom_microbatch_strategy": false, "profiles_dir": "/home/paula/.dbt", "require_all_warnings_handled_by_warn_error": false, "use_fast_test_edges": false, "favor_state": false, "quiet": false, "populate_cache": true, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "upload_to_artifacts_ingest_api": false, "log_format": "default", "validate_macro_args": false, "strict_mode": false, "log_format_file": "debug", "indirect_selection": "eager", "show_resource_report": false, "show": false, "include_saved_query": false, "partial_parse_file_diff": true, "log_level": "info", "partial_parse": true, "macro_debugging": false, "require_yaml_configuration_for_mf_time_spines": false, "print": true, "use_colors": true, "write_json": true, "target": "databricks", "send_anonymous_usage_stats": true, "cache_selected_only": false, "exclude": [], "empty": false, "introspect": true, "log_path": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights/logs", "select": [], "static_parser": true, "printer_width": 80, "exclude_resource_types": [], "target_path": "target_databricks"}}