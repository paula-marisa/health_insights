{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-14T17:25:46.552015Z", "invocation_id": "dfa075dd-aa8f-4abf-891d-d2569ed8ce0b", "invocation_started_at": "2025-08-14T17:25:07.548912Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.145984Z", "completed_at": "2025-08-14T17:25:43.147515Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.156017Z", "completed_at": "2025-08-14T17:25:43.156039Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05940532684326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.health_insights.ref_municipios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.149230Z", "completed_at": "2025-08-14T17:25:43.150714Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.158144Z", "completed_at": "2025-08-14T17:25:43.158156Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.059771060943603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.health_insights.ref_uf", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.113833Z", "completed_at": "2025-08-14T17:25:43.169311Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.173830Z", "completed_at": "2025-08-14T17:25:43.173843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08077883720397949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.check_conn", "compiled": true, "compiled_code": "\nselect current_user() as user_name, current_catalog() as catalog_name,\n       current_schema() as schema_name, current_timestamp() as ts", "relation_name": "`health_insights`.`raw_stg`.`check_conn`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.179347Z", "completed_at": "2025-08-14T17:25:43.230667Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.233016Z", "completed_at": "2025-08-14T17:25:43.233034Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0669405460357666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_ref_municipios_municipio_code.36fb7df381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom `health_insights`.`raw_stg_marts`.`ref_municipios`\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.192808Z", "completed_at": "2025-08-14T17:25:43.231468Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.235549Z", "completed_at": "2025-08-14T17:25:43.235562Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0673058032989502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_ref_municipios_municipio_code.f1ab57dc22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipio_code as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg_marts`.`ref_municipios`\nwhere municipio_code is not null\ngroup by municipio_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.210199Z", "completed_at": "2025-08-14T17:25:43.244029Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.248329Z", "completed_at": "2025-08-14T17:25:43.248358Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04865717887878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_localidade", "compiled": true, "compiled_code": "-- models/marts/dim/dim_localidade.sql\n\n\nwith muni as (\n  select\n    municipio_code,              -- vem do seed\n    uf_sigla       as state_code,\n    municipio_nome,\n    regiao\n  from `health_insights`.`raw_stg_marts`.`ref_municipios`\n),\nufs as (\n  select\n    uf_sigla as state_code,\n    uf_nome  as state_name\n  from `health_insights`.`raw_stg_marts`.`ref_uf`\n)\nselect\n  md5(cast(concat(coalesce(cast(m.municipio_code as string), '_dbt_utils_surrogate_key_null_')) as string)) as sk_localidade,\n  m.municipio_code  as municipality_code,\n  m.state_code,\n  u.state_name,\n  m.municipio_nome  as nome_municipio,\n  m.regiao\nfrom muni m\nleft join ufs u using (state_code)", "relation_name": "`health_insights`.`marts`.`dim_localidade`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.260682Z", "completed_at": "2025-08-14T17:25:43.284910Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.286915Z", "completed_at": "2025-08-14T17:25:43.286929Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04388856887817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_ref_uf_uf_sigla.f1ac44888d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    uf_sigla as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg_marts`.`ref_uf`\nwhere uf_sigla is not null\ngroup by uf_sigla\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.255424Z", "completed_at": "2025-08-14T17:25:43.285697Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.288696Z", "completed_at": "2025-08-14T17:25:43.288728Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0478968620300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_ref_uf_uf_sigla.28d0cf764d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect uf_sigla\nfrom `health_insights`.`raw_stg_marts`.`ref_uf`\nwhere uf_sigla is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.276420Z", "completed_at": "2025-08-14T17:25:43.295311Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.299921Z", "completed_at": "2025-08-14T17:25:43.299935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03181004524230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_municipality_code.c333a34ef4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipality_code\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere municipality_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.316041Z", "completed_at": "2025-08-14T17:25:43.337252Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.339319Z", "completed_at": "2025-08-14T17:25:43.339333Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04281282424926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_sk_localidade.4e64780a4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_localidade\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere sk_localidade is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.308252Z", "completed_at": "2025-08-14T17:25:43.337851Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.341307Z", "completed_at": "2025-08-14T17:25:43.341335Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04737424850463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_nome_municipio.308dae2d1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_municipio\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere nome_municipio is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.328559Z", "completed_at": "2025-08-14T17:25:43.346911Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.350553Z", "completed_at": "2025-08-14T17:25:43.350566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03653407096862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_localidade_state_code.c73ddb8f97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.360157Z", "completed_at": "2025-08-14T17:25:43.379761Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.382091Z", "completed_at": "2025-08-14T17:25:43.382104Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03462362289428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_localidade_municipality_code.fc817a75fb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipality_code as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere municipality_code is not null\ngroup by municipality_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.365194Z", "completed_at": "2025-08-14T17:25:43.381594Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.383846Z", "completed_at": "2025-08-14T17:25:43.383854Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03478550910949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_localidade_sk_localidade.9a9ecd5e89", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_localidade as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_localidade`\nwhere sk_localidade is not null\ngroup by sk_localidade\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.124422Z", "completed_at": "2025-08-14T17:25:43.770299Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.771816Z", "completed_at": "2025-08-14T17:25:43.771831Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6770269870758057, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.stg_births", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nwith src as (\n  select * from `health_insights`.`raw_stg`.`sinasc_raw`\n),\n\nk as (\n  \n  \n  \n    \n      \n        \n      \n    \n  \n    \n  \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  select\n    s.*,\n    row_number() over (\n      order by \n  \n    cast(DTNASC as string)\n  \n, \n  \n    cast(CODMUNNASC as string)\n  \n, \n  \n    cast(SEXO as string)\n  \n, \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n\n    ) as rn\n  from src s\n),\n\nnorm as (\n  select\n    -- usa CONTADOR/CODMUNNASC se existirem; caso contr\u00e1rio usa NULL para estabilizar o hash\n    md5(\n      coalesce( cast(null as string) , '') || '-' ||\n      coalesce( \n  \n    cast(CODMUNNASC as string)\n  \n , '') || '-' ||\n      lpad(\n  \n    cast(rn as string)\n  \n, 10, '0')\n    ) as sk_birth,\n\n    -- data de nascimento: v\u00e1rias formas\n    case\n      when \n  \n    (\n  \n    cast(DTNASC as string)\n  \n rlike '^[0-9]{4}-[0-9]{2}-[0-9]{2}$')\n  \n then\n        \n  \n    \n      to_date(\n  \n    cast(DTNASC as string)\n  \n)\n    \n  \n\n      when \n  \n    (regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]','') rlike '^[0-9]{8}$')\n  \n then\n        coalesce(\n          \n  \n    \n      to_date(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 'ddmmyyyy')\n    \n  \n,\n          \n  \n    \n      to_date(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 'yyyymmdd')\n    \n  \n\n        )\n      when \n  \n    (regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]','') rlike '^[0-9]{7}$')\n  \n then\n        \n  \n    \n      to_date(lpad(regexp_replace(\n  \n    cast(DTNASC as string)\n  \n,'[^0-9]',''), 8, '0'), 'ddmmyyyy')\n    \n  \n\n      else null\n    end as birth_date,\n\n    case \n  \n    cast(SEXO as string)\n  \n\n      when '1' then 'M'\n      when '2' then 'F'\n      else 'U'\n    end as sex_newborn,\n\n             \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n        as birth_weight_g,\n         \n  \n    cast(GESTACAO as string)\n  \n    as gestation_code,\n       \n  -- int funciona em Snowflake e Spark\n  cast(SEMAGESTAC as int)\n  as gestational_weeks,\n     cast(null as string)  as delivery_type,\n       \n  \n    cast(CODMUNNASC as string)\n  \n  as municipality_code\n  from k\n)\n\nselect\n  sk_birth, birth_date, sex_newborn, birth_weight_g,\n  gestation_code, gestational_weeks, delivery_type, municipality_code,\n  \n  \n    date_format(birth_date, 'yyyy-MM')\n  \n as ym\nfrom norm\nwhere birth_date is not null", "relation_name": "`health_insights`.`raw_stg`.`stg_births`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.812332Z", "completed_at": "2025-08-14T17:25:43.831287Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.833938Z", "completed_at": "2025-08-14T17:25:43.833967Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05440235137939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_stg_births_birth_date.6972dfbab3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect birth_date\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere birth_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.795802Z", "completed_at": "2025-08-14T17:25:43.831993Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.836273Z", "completed_at": "2025-08-14T17:25:43.836285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05977511405944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.int_births_enriched", "compiled": true, "compiled_code": "\n\nwith s as (\n  select * from `health_insights`.`raw_stg`.`stg_births`\n)\nselect\n  s.sk_birth,\n  s.municipality_code,\n  s.birth_date,\n  \n  \n    \n      to_date(concat(s.ym, '-01'))\n    \n  \n as year_month_date,\n  s.ym,\n\n  -- CAMPOS QUE A FATO PRECISA:\n  s.sex_newborn,\n  /* ajuste os nomes conforme existirem no teu stg_births */\n  s.birth_weight_g         as birth_weight_g,      -- se no stg for 'peso_nascimento_g', mapeia: s.peso_nascimento_g as birth_weight_g\n  s.gestational_weeks      as gestational_weeks,   -- idem ('semanas_gestacao' -> gestational_weeks)\n  s.delivery_type          as delivery_type,       -- idem ('tipo_parto' -> delivery_type)\n\n  -- outros campos \u00fateis\n  substr(cast(s.municipality_code as string), 1, 2) as state_code\nfrom s", "relation_name": "`health_insights`.`silver`.`int_births_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.802533Z", "completed_at": "2025-08-14T17:25:43.832591Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.838278Z", "completed_at": "2025-08-14T17:25:43.838310Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06021285057067871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_stg_births_sex_newborn__M__F__U.37e37a471e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`raw_stg`.`stg_births`\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.817217Z", "completed_at": "2025-08-14T17:25:43.835216Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.842125Z", "completed_at": "2025-08-14T17:25:43.842136Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.061009883880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_stg_births_sk_birth.3de4ffc9db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.872689Z", "completed_at": "2025-08-14T17:25:43.895423Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.898280Z", "completed_at": "2025-08-14T17:25:43.898298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04834413528442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_faixa_etaria_sexo", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT DISTINCT\n    sex_newborn\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  md5(coalesce(sex_newborn,'') || '|desconhecido') AS sk_faixa_etaria_sexo,\n  'desconhecido'                                   AS faixa_etaria_mae,\n  sex_newborn                                      AS sexo_bebe\nFROM s", "relation_name": "`health_insights`.`marts`.`dim_faixa_etaria_sexo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.865385Z", "completed_at": "2025-08-14T17:25:43.896250Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.900883Z", "completed_at": "2025-08-14T17:25:43.900912Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05432319641113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_stg_births_sk_birth.744376c997", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`raw_stg`.`stg_births`\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.876722Z", "completed_at": "2025-08-14T17:25:43.897087Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.903429Z", "completed_at": "2025-08-14T17:25:43.903444Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05179715156555176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_mae", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT municipality_code, ym\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  -- port\u00e1til entre Snowflake e Databricks\n  md5(cast(concat(coalesce(cast(municipality_code as string), '_dbt_utils_surrogate_key_null_'), '-', coalesce(cast(ym as string), '_dbt_utils_surrogate_key_null_')) as string)) AS sk_mae,\n  CAST(NULL AS INT)                                                  AS idade_mae,      -- <- era NUMBER\n  'desconhecido'                                                     AS faixa_etaria_mae,\n  'desconhecido'                                                     AS escolaridade_mae\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "`health_insights`.`marts`.`dim_mae`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.883190Z", "completed_at": "2025-08-14T17:25:43.899344Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.907882Z", "completed_at": "2025-08-14T17:25:43.907899Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.052652835845947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_recem_nascido", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks\n  FROM `health_insights`.`silver`.`int_births_enriched`\n)\nSELECT\n  md5(\n    coalesce(sex_newborn,'') || '|' ||\n    coalesce(\n      CASE\n        WHEN birth_weight_g IS NULL THEN 'desconhecido'\n        WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n        WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n        ELSE 'adequado'\n      END, ''\n    ) || '|' ||\n    coalesce(\n      CASE\n        WHEN gestational_weeks IS NULL THEN 'desconhecido'\n        WHEN gestational_weeks < 37    THEN 'pre_termo'\n        WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n        WHEN gestational_weeks >= 42   THEN 'pos_termo'\n      END, ''\n    )\n  )                                    AS sk_recem_nascido,\n  sex_newborn                           AS sexo_bebe,\n  CASE\n    WHEN birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END                                   AS categoria_peso,\n  CASE\n    WHEN gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN gestational_weeks < 37    THEN 'pre_termo'\n    WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN gestational_weeks >= 42   THEN 'pos_termo'\n  END                                   AS categoria_gestacao\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "`health_insights`.`marts`.`dim_recem_nascido`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.935362Z", "completed_at": "2025-08-14T17:25:43.973149Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.975820Z", "completed_at": "2025-08-14T17:25:43.975865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0622556209564209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.dim_tempo", "compiled": true, "compiled_code": "\n\nwith d as (\n  select distinct \n  \n    cast(birth_date as date)\n  \n as data\n  from `health_insights`.`silver`.`int_births_enriched`\n  where birth_date is not null\n)\nselect\n  md5(\n  \n    date_format(data, 'yyyy-MM-dd')\n  \n)      as sk_tempo,\n  data                                as data_dia,\n  year(data)                          as ano,\n  month(data)                         as mes,\n  \n  \n    date_format(data, 'yyyy-MM')\n  \n             as ym,\n  quarter(data)                       as trimestre,\n  \n  \n    -- dayofweek: Dom=1 .. Sab=7 \u2192 converter para ISO (Seg=1 .. Dom=7)\n    (((dayofweek(data) + 5) % 7) + 1)\n  \n             as dia_semana_iso,\n  case when \n  \n    -- dayofweek: Dom=1 .. Sab=7 \u2192 converter para ISO (Seg=1 .. Dom=7)\n    (((dayofweek(data) + 5) % 7) + 1)\n  \n in (6,7) then 1 else 0 end as is_fim_semana\nfrom d", "relation_name": "`health_insights`.`marts`.`dim_tempo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.945873Z", "completed_at": "2025-08-14T17:25:43.974120Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.978604Z", "completed_at": "2025-08-14T17:25:43.978616Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05949282646179199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.fato_nascimentos_enriquecido", "compiled": true, "compiled_code": "-- models/marts/fato_nascimentos_enriquecido.sql\n\n\nwith f as (\n  select * from `health_insights`.`silver`.`int_births_enriched`\n)\nselect\n  f.*,\n  d.sk_localidade,\n  d.nome_municipio,\n  d.state_name\nfrom f\nleft join `health_insights`.`marts`.`dim_localidade` d\n  on d.municipality_code = f.municipality_code", "relation_name": "`health_insights`.`marts`.`fato_nascimentos_enriquecido`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.951055Z", "completed_at": "2025-08-14T17:25:43.974776Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.980659Z", "completed_at": "2025-08-14T17:25:43.980669Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05967831611633301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_faixa_etaria_mae__desconhecido.c2da527898", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_faixa_etaria_sexo`\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:43.958673Z", "completed_at": "2025-08-14T17:25:43.977604Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:43.984492Z", "completed_at": "2025-08-14T17:25:43.984521Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.060423851013183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_sexo_bebe__M__F__U.362c430907", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_faixa_etaria_sexo`\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.010146Z", "completed_at": "2025-08-14T17:25:44.045765Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.048149Z", "completed_at": "2025-08-14T17:25:44.048181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05883431434631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.852c7b558e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_faixa_etaria_sexo\nfrom `health_insights`.`marts`.`dim_faixa_etaria_sexo`\nwhere sk_faixa_etaria_sexo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.022489Z", "completed_at": "2025-08-14T17:25:44.047172Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.051220Z", "completed_at": "2025-08-14T17:25:44.051252Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.056339263916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_mae_faixa_etaria_mae__desconhecido.d11e899e97", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_mae`\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.016942Z", "completed_at": "2025-08-14T17:25:44.049542Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.054917Z", "completed_at": "2025-08-14T17:25:44.054928Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06166648864746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.b936648aef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_faixa_etaria_sexo as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_faixa_etaria_sexo`\nwhere sk_faixa_etaria_sexo is not null\ngroup by sk_faixa_etaria_sexo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.029764Z", "completed_at": "2025-08-14T17:25:44.050211Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.056843Z", "completed_at": "2025-08-14T17:25:44.056855Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05851244926452637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_mae_sk_mae.c687c74418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_mae\nfrom `health_insights`.`marts`.`dim_mae`\nwhere sk_mae is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.079695Z", "completed_at": "2025-08-14T17:25:44.113183Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.117612Z", "completed_at": "2025-08-14T17:25:44.117634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05734419822692871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_mae_sk_mae.ba5d0f9bdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_mae as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_mae`\nwhere sk_mae is not null\ngroup by sk_mae\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.088763Z", "completed_at": "2025-08-14T17:25:44.124333Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.127784Z", "completed_at": "2025-08-14T17:25:44.127799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06279754638671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_gestacao__pre_termo__termo__pos_termo__desconhecido.1c35f10411", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_gestacao as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by categoria_gestacao\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pre_termo','termo','pos_termo','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.097074Z", "completed_at": "2025-08-14T17:25:44.125069Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.130684Z", "completed_at": "2025-08-14T17:25:44.130698Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06253862380981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_peso__baixo_peso__adequado__macrossomico__desconhecido.5ffeee162e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_peso as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by categoria_peso\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'baixo_peso','adequado','macrossomico','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.106092Z", "completed_at": "2025-08-14T17:25:44.129096Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.139632Z", "completed_at": "2025-08-14T17:25:44.139644Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06981420516967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_sexo_bebe__M__F__U.5134deaa4d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`dim_recem_nascido`\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.132495Z", "completed_at": "2025-08-14T17:25:44.158622Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.169285Z", "completed_at": "2025-08-14T17:25:44.169300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048186540603637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_recem_nascido_sk_recem_nascido.ad02f86bcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_recem_nascido\nfrom `health_insights`.`marts`.`dim_recem_nascido`\nwhere sk_recem_nascido is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.161077Z", "completed_at": "2025-08-14T17:25:44.203044Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.207398Z", "completed_at": "2025-08-14T17:25:44.207417Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06334733963012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_recem_nascido_sk_recem_nascido.91c6374a3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_recem_nascido as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_recem_nascido`\nwhere sk_recem_nascido is not null\ngroup by sk_recem_nascido\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.171062Z", "completed_at": "2025-08-14T17:25:44.203867Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.209942Z", "completed_at": "2025-08-14T17:25:44.209966Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0621185302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.fato_nascimentos", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    sk_birth,\n    birth_date,\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks,\n    delivery_type,\n    municipality_code,\n    -- categorias para link com dim_recem_nascido\n    case\n      when birth_weight_g is null then 'desconhecido'\n      when birth_weight_g < 2500   then 'baixo_peso'\n      when birth_weight_g >= 4000  then 'macrossomico'\n      else 'adequado'\n    end as categoria_peso,\n    case\n      when gestational_weeks is null then 'desconhecido'\n      when gestational_weeks < 37    then 'pre_termo'\n      when gestational_weeks between 37 and 41 then 'termo'\n      when gestational_weeks >= 42   then 'pos_termo'\n    end as categoria_gestacao\n  from `health_insights`.`silver`.`int_births_enriched`\n  \n    where birth_date >= (\n      select coalesce(max(t.data_dia),'1900-01-01'::date)\n      from `health_insights`.`marts`.`fato_nascimentos` f\n      join `health_insights`.`marts`.`dim_tempo` t on f.fk_sk_tempo = t.sk_tempo\n    )\n  \n),\n\nlk_tempo as (\n  select sk_tempo, data_dia\n  from `health_insights`.`marts`.`dim_tempo`\n),\n\nlk_localidade as (\n  select sk_localidade, municipality_code\n  from `health_insights`.`marts`.`dim_localidade`\n),\n\nlk_recem as (\n  select sk_recem_nascido, sexo_bebe, categoria_peso, categoria_gestacao\n  from `health_insights`.`marts`.`dim_recem_nascido`\n)\n\nselect\n  -- chaves\n  s.sk_birth,\n  t.sk_tempo            as fk_sk_tempo,\n  dloc.sk_localidade    as fk_sk_localidade,\n  drec.sk_recem_nascido as fk_sk_recem_nascido,\n\n  -- MEDIDAS / ATRIBUTOS para o dashboard\n  s.sex_newborn,\n  s.birth_weight_g,\n  s.gestational_weeks,\n  s.delivery_type\nfrom src s\nleft join lk_tempo      t    on s.birth_date = t.data_dia\nleft join lk_localidade dloc on s.municipality_code = dloc.municipality_code\nleft join lk_recem      drec\n       on drec.sexo_bebe = s.sex_newborn\n      and drec.categoria_peso = s.categoria_peso\n      and drec.categoria_gestacao = s.categoria_gestacao", "relation_name": "`health_insights`.`marts`.`fato_nascimentos`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.188303Z", "completed_at": "2025-08-14T17:25:44.204536Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.212326Z", "completed_at": "2025-08-14T17:25:44.212347Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.060724735260009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_tempo_data_dia.fe310f51fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_dia\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere data_dia is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.215043Z", "completed_at": "2025-08-14T17:25:44.244421Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.261327Z", "completed_at": "2025-08-14T17:25:44.261343Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06198716163635254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_dim_tempo_sk_tempo.a5f54edc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_tempo\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere sk_tempo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.254000Z", "completed_at": "2025-08-14T17:25:44.278368Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.282359Z", "completed_at": "2025-08-14T17:25:44.282373Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05058622360229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.fed_fato", "compiled": true, "compiled_code": "\n\nwith f as (\n  select * from `health_insights`.`marts`.`fato_nascimentos`\n),\nt as (\n  select sk_tempo, data_dia, ano, mes from `health_insights`.`marts`.`dim_tempo`\n)\nselect\n  -- colunas necess\u00e1rias da fato\n  f.sk_birth,\n  f.fk_sk_tempo,\n  f.fk_sk_localidade,\n  f.birth_weight_g,\n  f.gestational_weeks,\n  f.delivery_type,\n\n  -- birth_date (compat\u00edvel)\n  \n    t.data_dia as birth_date,\n  \n\n  -- ym can\u00f3nico yyyy-MM\n  \n    lpad(cast(t.ano as string), 4, '0') || '-' || lpad(cast(t.mes as string), 2, '0') as ym\n  \nfrom f\nleft join t\n  on f.fk_sk_tempo = t.sk_tempo", "relation_name": "`health_insights`.`silver`.`fed_fato`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.263353Z", "completed_at": "2025-08-14T17:25:44.279184Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.284416Z", "completed_at": "2025-08-14T17:25:44.284430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05070352554321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.fed_kpis", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, \n  \n    date_format(data_dia, 'yyyy-MM')\n  \n AS ym\n  FROM `health_insights`.`marts`.`dim_tempo`\n)\nSELECT\n  t.ym,\n  COUNT(*) AS total_nascimentos,\n  AVG(CASE WHEN f.gestational_weeks IS NOT NULL AND f.gestational_weeks < 37 THEN 1 ELSE 0 END) AS pct_prematuros,\n  AVG(CASE WHEN f.birth_weight_g    IS NOT NULL AND f.birth_weight_g    < 2500 THEN 1 ELSE 0 END) AS pct_baixo_peso,\n  AVG(CASE WHEN UPPER(f.delivery_type) IN ('C','CESAREA','CES\u00c1REA','CESAREAN','CESARIANA') THEN 1 ELSE 0 END) AS pct_cesarianas\nFROM f\nJOIN t ON f.fk_sk_tempo = t.sk_tempo\nGROUP BY 1", "relation_name": "`health_insights`.`silver`.`fed_kpis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.247476Z", "completed_at": "2025-08-14T17:25:44.281792Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.292818Z", "completed_at": "2025-08-14T17:25:44.292834Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06322240829467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_dim_tempo_sk_tempo.2def1c13e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_tempo as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`dim_tempo`\nwhere sk_tempo is not null\ngroup by sk_tempo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.286765Z", "completed_at": "2025-08-14T17:25:44.310643Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.315570Z", "completed_at": "2025-08-14T17:25:44.315583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04096341133117676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.kpis_mensais", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, \n  \n    date_format(data_dia, 'yyyy-MM')\n  \n AS ym\n  FROM `health_insights`.`marts`.`dim_tempo`\n),\nl AS (\n  SELECT sk_localidade, state_code, state_name\n  FROM `health_insights`.`marts`.`dim_localidade`\n)\nSELECT\n  t.ym,\n  l.state_code,\n  COUNT(*) AS total_nascimentos,\n  AVG(CASE WHEN UPPER(f.delivery_type) IN ('C','CESAREA','CES\u00c1REA') THEN 1 ELSE 0 END) AS pct_cesarianas\nFROM f\nJOIN t ON f.fk_sk_tempo = t.sk_tempo\nJOIN l ON f.fk_sk_localidade = l.sk_localidade\nGROUP BY 1,2", "relation_name": "`health_insights`.`marts`.`kpis_mensais`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.317216Z", "completed_at": "2025-08-14T17:25:44.344857Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.357367Z", "completed_at": "2025-08-14T17:25:44.357396Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05675196647644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.health_insights.quality_metrics", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM `health_insights`.`marts`.`fato_nascimentos`\n),\nt AS (\n  SELECT sk_tempo, data_dia\n  FROM `health_insights`.`marts`.`dim_tempo`\n)\nSELECT\n  t.data_dia AS birth_date,\n  \n  \n    date_format(t.data_dia, 'yyyy-MM')\n  \n AS ym,\n  COUNT(*) AS n_registos,\n  AVG(CASE WHEN f.birth_weight_g    IS NULL THEN 1 ELSE 0 END) AS pct_sem_peso,\n  AVG(CASE WHEN f.gestational_weeks IS NULL THEN 1 ELSE 0 END) AS pct_sem_gestacao\nFROM f\nLEFT JOIN t ON f.fk_sk_tempo = t.sk_tempo\nGROUP BY 1,2", "relation_name": "`health_insights`.`marts`.`quality_metrics`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.329006Z", "completed_at": "2025-08-14T17:25:44.351054Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.360199Z", "completed_at": "2025-08-14T17:25:44.360210Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0554957389831543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.not_null_fato_nascimentos_sk_birth.e98a446ce9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom `health_insights`.`marts`.`fato_nascimentos`\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.322304Z", "completed_at": "2025-08-14T17:25:44.358661Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.365837Z", "completed_at": "2025-08-14T17:25:44.365853Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06361198425292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.accepted_values_fato_nascimentos_sex_newborn__M__F__U.4111c16aa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from `health_insights`.`marts`.`fato_nascimentos`\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.345882Z", "completed_at": "2025-08-14T17:25:44.378806Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.385833Z", "completed_at": "2025-08-14T17:25:44.385848Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04557228088378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_localidade__sk_localidade__ref_dim_localidade_.cee28b6216", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_localidade as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_localidade is not null\n),\n\nparent as (\n    select sk_localidade as to_field\n    from `health_insights`.`marts`.`dim_localidade`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.389603Z", "completed_at": "2025-08-14T17:25:44.426785Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.429532Z", "completed_at": "2025-08-14T17:25:44.429550Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05942416191101074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_recem_nascido__sk_recem_nascido__ref_dim_recem_nascido_.4bc6e8e0f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_recem_nascido as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_recem_nascido is not null\n),\n\nparent as (\n    select sk_recem_nascido as to_field\n    from `health_insights`.`marts`.`dim_recem_nascido`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.410235Z", "completed_at": "2025-08-14T17:25:44.427913Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.432378Z", "completed_at": "2025-08-14T17:25:44.432392Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.054720401763916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.unique_fato_nascimentos_sk_birth.987afa4974", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom `health_insights`.`marts`.`fato_nascimentos`\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:25:44.399840Z", "completed_at": "2025-08-14T17:25:44.430853Z"}, {"name": "execute", "started_at": "2025-08-14T17:25:44.435792Z", "completed_at": "2025-08-14T17:25:44.435805Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.061997175216674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_tempo__sk_tempo__ref_dim_tempo_.c417b97fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_tempo as from_field\n    from `health_insights`.`marts`.`fato_nascimentos`\n    where fk_sk_tempo is not null\n),\n\nparent as (\n    select sk_tempo as to_field\n    from `health_insights`.`marts`.`dim_tempo`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 6.4400787353515625, "args": {"invocation_command": "dbt docs generate --target databricks --target-path target_databricks", "profiles_dir": "/home/paula/.dbt", "static": false, "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "show_resource_report": false, "log_format_file": "debug", "target": "databricks", "use_colors": true, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "macro_debugging": false, "require_generic_test_arguments_property": false, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": true, "validate_macro_args": false, "write_json": true, "project_dir": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights", "exclude": [], "partial_parse_file_diff": true, "defer": false, "log_level_file": "debug", "use_fast_test_edges": false, "target_path": "target_databricks", "which": "generate", "skip_nodes_if_on_run_start_fails": false, "log_file_max_bytes": 10485760, "log_format": "default", "compile": true, "upload_to_artifacts_ingest_api": false, "strict_mode": false, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false, "static_parser": true, "send_anonymous_usage_stats": true, "log_path": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights/logs", "print": true, "require_yaml_configuration_for_mf_time_spines": false, "quiet": false, "show_all_deprecations": false, "state_modified_compare_vars": false, "vars": {}, "require_all_warnings_handled_by_warn_error": false, "populate_cache": true, "source_freshness_run_project_hooks": true, "use_colors_file": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "empty_catalog": false, "indirect_selection": "eager", "printer_width": 80, "select": [], "log_level": "info"}}