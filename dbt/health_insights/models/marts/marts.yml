version: 2

models:
- name: dim_tempo
  columns:
  - name: sk_tempo
    tests: [ not_null, unique ]
  - name: data_dia
    tests: [ not_null ]

- name: dim_localidade
  columns:
  - name: sk_localidade
    tests: [ not_null, unique ]
  - name: municipio_code
    tests: [ not_null ]

- name: dim_recem_nascido
  columns:
  - name: sk_recem_nascido
    tests: [ not_null, unique ]
  - name: sexo_bebe
    tests:
    - accepted_values:
        values: [ 'M', 'F', 'U' ]
  - name: categoria_peso
    tests:
    - accepted_values:
        values: [ 'baixo_peso', 'adequado', 'macrossomico', 'desconhecido' ]
  - name: categoria_gestacao
    tests:
    - accepted_values:
        values: [ 'pre_termo', 'termo', 'pos_termo', 'desconhecido' ]

- name: fato_nascimentos
  columns:
  - name: sk_birth
    tests: [ not_null, unique ]
  - name: fk_sk_tempo
    tests:
    - relationships:
        to: ref('dim_tempo')
        field: sk_tempo
  - name: fk_sk_localidade
    tests:
    - relationships:
        to: ref('dim_localidade')
        field: sk_localidade
  - name: fk_sk_recem_nascido
    tests:
    - relationships:
        to: ref('dim_recem_nascido')
        field: sk_recem_nascido
  - name: sex_newborn
    tests:
    - accepted_values:
        values: [ 'M', 'F', 'U' ]

- name: dim_mae
  columns:
  - name: sk_mae
    tests: [ not_null, unique ]
  # idade_mae pode ser NULL por agora; quando tiveres o campo real, adiciona not_null
  - name: faixa_etaria_mae
    tests:
    - accepted_values:
        values: [ 'desconhecido' ]

- name: dim_faixa_etaria_sexo
  columns:
  - name: sk_faixa_etaria_sexo
    tests: [ not_null, unique ]
  - name: faixa_etaria_mae
    tests:
    - accepted_values:
        values: [ 'desconhecido' ]
  - name: sexo_bebe
    tests:
    - accepted_values:
        values: [ 'M', 'F', 'U' ]
