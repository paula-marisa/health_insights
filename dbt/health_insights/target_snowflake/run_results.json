{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-14T15:26:40.293289Z", "invocation_id": "2fde3cc5-0718-4319-a82a-94ec2030b20d", "invocation_started_at": "2025-08-14T15:25:45.603933Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:20.505719Z", "completed_at": "2025-08-14T15:26:20.993439Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:20.995615Z", "completed_at": "2025-08-14T15:26:21.761678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.266650676727295, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3baa-000c-dcd70018542a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.stg_births", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nwith src as (\n  select * from HEALTH_INSIGHTS.RAW_STG.sinasc_raw\n),\n\nk as (\n  \n  \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n\n  select\n    s.*,\n    row_number() over (\n      order by \n  \n    cast(DTNASC as varchar)\n  \n, \n  \n    cast(HORANASC as varchar)\n  \n, \n  \n    cast(CODESTAB as varchar)\n  \n, \n  \n    cast(CODMUNNASC as varchar)\n  \n, \n  \n    cast(SEXO as varchar)\n  \n, \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n, \n  \n    cast(DTRECEBIM as varchar)\n  \n, \n  \n    cast(DTCADASTRO as varchar)\n  \n, \n  \n    cast(NUMEROLOTE as varchar)\n  \n, \n  \n    cast(CONTADOR as varchar)\n  \n\n    ) as rn\n  from src s\n),\n\nnorm as (\n  select\n    -- usa CONTADOR/CODMUNNASC se existirem; caso contr\u00e1rio usa NULL para estabilizar o hash\n    md5(\n      coalesce( \n  \n    cast(CONTADOR as varchar)\n  \n , '') || '-' ||\n      coalesce( \n  \n    cast(CODMUNNASC as varchar)\n  \n , '') || '-' ||\n      lpad(\n  \n    cast(rn as varchar)\n  \n, 10, '0')\n    ) as sk_birth,\n\n    -- data de nascimento: v\u00e1rias formas\n    case\n      when \n  \n    regexp_like(\n  \n    cast(DTNASC as varchar)\n  \n, '^[0-9]{4}-[0-9]{2}-[0-9]{2}$')\n  \n then\n        \n  \n    \n      try_to_date(\n  \n    cast(DTNASC as varchar)\n  \n)\n    \n  \n\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{8}$')\n  \n then\n        coalesce(\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'DDMMYYYY')\n    \n  \n,\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'YYYYMMDD')\n    \n  \n\n        )\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{7}$')\n  \n then\n        \n  \n    \n      try_to_date(lpad(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 8, '0'), 'DDMMYYYY')\n    \n  \n\n      else null\n    end as birth_date,\n\n    case \n  \n    cast(SEXO as varchar)\n  \n\n      when '1' then 'M'\n      when '2' then 'F'\n      else 'U'\n    end as sex_newborn,\n\n             \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n        as birth_weight_g,\n         \n  \n    cast(GESTACAO as varchar)\n  \n    as gestation_code,\n       \n  -- int funciona em Snowflake e Spark\n  cast(SEMAGESTAC as int)\n  as gestational_weeks,\n            \n  \n    cast(PARTO as varchar)\n  \n       as delivery_type,\n       \n  \n    cast(CODMUNNASC as varchar)\n  \n  as municipality_code\n  from k\n)\n\nselect\n  sk_birth, birth_date, sex_newborn, birth_weight_g,\n  gestation_code, gestational_weeks, delivery_type, municipality_code,\n  \n  \n    to_char(birth_date, 'YYYY-MM')\n  \n as ym\nfrom norm\nwhere birth_date is not null", "relation_name": "HEALTH_INSIGHTS.raw_stg.stg_births", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:21.794660Z", "completed_at": "2025-08-14T15:26:23.014415Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:23.016092Z", "completed_at": "2025-08-14T15:26:24.480477Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.6931557655334473, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b09-000c-dcd70017c4e6"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_stg_births_sex_newborn__M__F__U.37e37a471e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.raw_stg.stg_births\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:22.995335Z", "completed_at": "2025-08-14T15:26:23.022175Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:23.038600Z", "completed_at": "2025-08-14T15:26:24.772506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.9828851222991943, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d356"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_birth_date.6972dfbab3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect birth_date\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere birth_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:20.540473Z", "completed_at": "2025-08-14T15:26:20.540482Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:20.565879Z", "completed_at": "2025-08-14T15:26:25.004699Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.5063159465789795, "adapter_response": {"_message": "INSERT 27", "code": "INSERT", "rows_affected": 27}, "message": "INSERT 27", "failures": null, "unique_id": "seed.health_insights.ref_uf", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:20.529265Z", "completed_at": "2025-08-14T15:26:20.529276Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:20.541909Z", "completed_at": "2025-08-14T15:26:25.009407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.512754678726196, "adapter_response": {"_message": "INSERT 10", "code": "INSERT", "rows_affected": 10}, "message": "INSERT 10", "failures": null, "unique_id": "seed.health_insights.ref_municipios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:25.030813Z", "completed_at": "2025-08-14T15:26:25.053925Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:25.056433Z", "completed_at": "2025-08-14T15:26:25.504830Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4812338352203369, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d35a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_uf_uf_sigla.28d0cf764d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect uf_sigla\nfrom HEALTH_INSIGHTS.RAW_STG.ref_uf\nwhere uf_sigla is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:25.040855Z", "completed_at": "2025-08-14T15:26:25.055791Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:25.060231Z", "completed_at": "2025-08-14T15:26:25.584220Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5550870895385742, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3abc-000c-dcd700176e0a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_uf_uf_sigla.f1ac44888d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    uf_sigla as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG.ref_uf\nwhere uf_sigla is not null\ngroup by uf_sigla\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:24.506070Z", "completed_at": "2025-08-14T15:26:24.526052Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:24.527447Z", "completed_at": "2025-08-14T15:26:25.918108Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.41725754737854, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3abc-000c-dcd700176e06"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_sk_birth.3de4ffc9db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:25.528045Z", "completed_at": "2025-08-14T15:26:25.551954Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:25.553398Z", "completed_at": "2025-08-14T15:26:26.015154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.49377870559692383, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3c48-000c-dcd7001823c2"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_municipios_municipio_code.36fb7df381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom HEALTH_INSIGHTS.RAW_STG.ref_municipios\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:25.596568Z", "completed_at": "2025-08-14T15:26:25.614837Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:25.616388Z", "completed_at": "2025-08-14T15:26:26.319386Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7277350425720215, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3baa-000c-dcd70018542e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_municipios_municipio_code.f1ab57dc22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipio_code as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG.ref_municipios\nwhere municipio_code is not null\ngroup by municipio_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:24.791108Z", "completed_at": "2025-08-14T15:26:24.813896Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:24.815677Z", "completed_at": "2025-08-14T15:26:26.429317Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.644066333770752, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3ce3-000c-dcd700188062"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_stg_births_sk_birth.744376c997", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:26.440769Z", "completed_at": "2025-08-14T15:26:26.457860Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:26.459027Z", "completed_at": "2025-08-14T15:26:27.117972Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6809782981872559, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d35e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.int_births_enriched", "compiled": true, "compiled_code": "\n\nwith s as (\n  select * from HEALTH_INSIGHTS.raw_stg.stg_births\n)\nselect\n  s.sk_birth,\n  s.municipality_code,\n  s.birth_date,\n  \n  \n    \n      try_to_date(concat(s.ym, '-01'))\n    \n  \n as year_month_date,\n  s.ym,\n\n  -- CAMPOS QUE A FATO PRECISA:\n  s.sex_newborn,\n  /* ajuste os nomes conforme existirem no teu stg_births */\n  s.birth_weight_g         as birth_weight_g,      -- se no stg for 'peso_nascimento_g', mapeia: s.peso_nascimento_g as birth_weight_g\n  s.gestational_weeks      as gestational_weeks,   -- idem ('semanas_gestacao' -> gestational_weeks)\n  s.delivery_type          as delivery_type,       -- idem ('tipo_parto' -> delivery_type)\n\n  -- outros campos \u00fateis\n  substr(cast(s.municipality_code as string), 1, 2) as state_code\nfrom s", "relation_name": "HEALTH_INSIGHTS.silver.int_births_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:26.331600Z", "completed_at": "2025-08-14T15:26:26.352754Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:26.354819Z", "completed_at": "2025-08-14T15:26:27.711112Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3835723400115967, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-39dd-000c-dcd70018618a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_localidade", "compiled": true, "compiled_code": "-- models/marts/dim/dim_localidade.sql\n\n\nwith muni as (\n  select\n    municipio_code,              -- vem do seed\n    uf_sigla       as state_code,\n    municipio_nome,\n    regiao\n  from HEALTH_INSIGHTS.RAW_STG.ref_municipios\n),\nufs as (\n  select\n    uf_sigla as state_code,\n    uf_nome  as state_name\n  from HEALTH_INSIGHTS.RAW_STG.ref_uf\n)\nselect\n  md5(cast(coalesce(cast(m.municipio_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sk_localidade,\n  m.municipio_code  as municipality_code,\n  m.state_code,\n  u.state_name,\n  m.municipio_nome  as nome_municipio,\n  m.regiao\nfrom muni m\nleft join ufs u using (state_code)", "relation_name": "HEALTH_INSIGHTS.marts.dim_localidade", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:27.150008Z", "completed_at": "2025-08-14T15:26:27.174947Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:27.177248Z", "completed_at": "2025-08-14T15:26:28.816422Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6764516830444336, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-39dd-000c-dcd70018618e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_faixa_etaria_sexo", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT DISTINCT\n    sex_newborn\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  md5(coalesce(sex_newborn,'') || '|desconhecido') AS sk_faixa_etaria_sexo,\n  'desconhecido'                                   AS faixa_etaria_mae,\n  sex_newborn                                      AS sexo_bebe\nFROM s", "relation_name": "HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:27.161335Z", "completed_at": "2025-08-14T15:26:27.180413Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:27.186940Z", "completed_at": "2025-08-14T15:26:28.970556Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8266520500183105, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3abc-000c-dcd700176e0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_recem_nascido", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  md5(\n    coalesce(sex_newborn,'') || '|' ||\n    coalesce(\n      CASE\n        WHEN birth_weight_g IS NULL THEN 'desconhecido'\n        WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n        WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n        ELSE 'adequado'\n      END, ''\n    ) || '|' ||\n    coalesce(\n      CASE\n        WHEN gestational_weeks IS NULL THEN 'desconhecido'\n        WHEN gestational_weeks < 37    THEN 'pre_termo'\n        WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n        WHEN gestational_weeks >= 42   THEN 'pos_termo'\n      END, ''\n    )\n  )                                    AS sk_recem_nascido,\n  sex_newborn                           AS sexo_bebe,\n  CASE\n    WHEN birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END                                   AS categoria_peso,\n  CASE\n    WHEN gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN gestational_weeks < 37    THEN 'pre_termo'\n    WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN gestational_weeks >= 42   THEN 'pos_termo'\n  END                                   AS categoria_gestacao\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.marts.dim_recem_nascido", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:28.836641Z", "completed_at": "2025-08-14T15:26:28.862307Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:28.864071Z", "completed_at": "2025-08-14T15:26:29.398338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5672969818115234, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b8b-000c-dcd70017f362"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_municipality_code.c333a34ef4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipality_code\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere municipality_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:27.156715Z", "completed_at": "2025-08-14T15:26:27.175752Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:27.181546Z", "completed_at": "2025-08-14T15:26:29.517877Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.3757870197296143, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b8b-000c-dcd70017f35e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_mae", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    municipality_code,\n    ym\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  md5(coalesce(municipality_code::string,'') || '|' || coalesce(ym,'')) AS sk_mae,\n  CAST(NULL AS NUMBER)                                                  AS idade_mae,\n  'desconhecido'                                                        AS faixa_etaria_mae,\n  'desconhecido'                                                        AS escolaridade_mae\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.marts.dim_mae", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:27.737232Z", "completed_at": "2025-08-14T15:26:27.763015Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:27.764378Z", "completed_at": "2025-08-14T15:26:29.583597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.851801872253418, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d362"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_tempo", "compiled": true, "compiled_code": "\n\nwith d as (\n  select distinct \n  \n    cast(birth_date as date)\n  \n as data\n  from HEALTH_INSIGHTS.silver.int_births_enriched\n  where birth_date is not null\n)\nselect\n  md5(\n  \n    to_char(data, 'YYYY-MM-DD')\n  \n)      as sk_tempo,\n  data                                as data_dia,\n  year(data)                          as ano,\n  month(data)                         as mes,\n  \n  \n    to_char(data, 'YYYY-MM')\n  \n             as ym,\n  quarter(data)                       as trimestre,\n  \n  \n    dayofweekiso(data)\n  \n             as dia_semana_iso,\n  case when \n  \n    dayofweekiso(data)\n  \n in (6,7) then 1 else 0 end as is_fim_semana\nfrom d", "relation_name": "HEALTH_INSIGHTS.marts.dim_tempo", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:29.419588Z", "completed_at": "2025-08-14T15:26:29.440219Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:29.441690Z", "completed_at": "2025-08-14T15:26:29.894219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47959399223327637, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-39dd-000c-dcd700186192"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_sk_localidade.4e64780a4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_localidade\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere sk_localidade is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:29.551231Z", "completed_at": "2025-08-14T15:26:29.572399Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:29.574531Z", "completed_at": "2025-08-14T15:26:29.970518Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.42493391036987305, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3abc-000c-dcd700176e12"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_state_code.c73ddb8f97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:28.987268Z", "completed_at": "2025-08-14T15:26:29.003811Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:29.005348Z", "completed_at": "2025-08-14T15:26:29.973704Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9904072284698486, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b09-000c-dcd70017c4ea"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_nome_municipio.308dae2d1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_municipio\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere nome_municipio is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:29.602515Z", "completed_at": "2025-08-14T15:26:29.628136Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:29.629481Z", "completed_at": "2025-08-14T15:26:30.061004Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4651761054992676, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3ce3-000c-dcd700188066"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_municipality_code.fc817a75fb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipality_code as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere municipality_code is not null\ngroup by municipality_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:29.911536Z", "completed_at": "2025-08-14T15:26:29.930528Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:29.931812Z", "completed_at": "2025-08-14T15:26:30.296272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.38980603218078613, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d366"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_sk_localidade.9a9ecd5e89", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_localidade as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere sk_localidade is not null\ngroup by sk_localidade\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:29.996264Z", "completed_at": "2025-08-14T15:26:30.017521Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.019762Z", "completed_at": "2025-08-14T15:26:30.380461Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.39190006256103516, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3ce3-000c-dcd70018806a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_faixa_etaria_mae__desconhecido.c2da527898", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.071769Z", "completed_at": "2025-08-14T15:26:30.090338Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.091794Z", "completed_at": "2025-08-14T15:26:30.451008Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3836944103240967, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-39dd-000c-dcd700186196"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.852c7b558e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_faixa_etaria_sexo\nfrom HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.001918Z", "completed_at": "2025-08-14T15:26:30.019163Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.024954Z", "completed_at": "2025-08-14T15:26:30.661527Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6712360382080078, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3c48-000c-dcd7001823c6"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_sexo_bebe__M__F__U.362c430907", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.389985Z", "completed_at": "2025-08-14T15:26:30.407939Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.409896Z", "completed_at": "2025-08-14T15:26:30.856656Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.46983981132507324, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b09-000c-dcd70017c4ee"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_gestacao__pre_termo__termo__pos_termo__desconhecido.1c35f10411", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_gestacao as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by categoria_gestacao\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pre_termo','termo','pos_termo','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.461910Z", "completed_at": "2025-08-14T15:26:30.486486Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.488918Z", "completed_at": "2025-08-14T15:26:30.875234Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.41701602935791016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3c48-000c-dcd7001823ca"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_peso__baixo_peso__adequado__macrossomico__desconhecido.5ffeee162e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_peso as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by categoria_peso\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'baixo_peso','adequado','macrossomico','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.308579Z", "completed_at": "2025-08-14T15:26:30.331435Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.332932Z", "completed_at": "2025-08-14T15:26:30.941243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6371169090270996, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3a88-000c-dcd7001715de"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.b936648aef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_faixa_etaria_sexo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is not null\ngroup by sk_faixa_etaria_sexo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.671604Z", "completed_at": "2025-08-14T15:26:30.689672Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.691793Z", "completed_at": "2025-08-14T15:26:31.155280Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.48765993118286133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3ce3-000c-dcd70018806e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_sexo_bebe__M__F__U.5134deaa4d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.889703Z", "completed_at": "2025-08-14T15:26:30.908144Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.910275Z", "completed_at": "2025-08-14T15:26:31.235307Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.34981274604797363, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3ce3-000c-dcd700188072"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_recem_nascido_sk_recem_nascido.91c6374a3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_recem_nascido as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_recem_nascido\nwhere sk_recem_nascido is not null\ngroup by sk_recem_nascido\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.868539Z", "completed_at": "2025-08-14T15:26:30.896931Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.899447Z", "completed_at": "2025-08-14T15:26:31.311548Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4478874206542969, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3baa-000c-dcd700185432"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_recem_nascido_sk_recem_nascido.ad02f86bcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_recem_nascido\nfrom HEALTH_INSIGHTS.marts.dim_recem_nascido\nwhere sk_recem_nascido is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:30.952132Z", "completed_at": "2025-08-14T15:26:30.969266Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:30.971762Z", "completed_at": "2025-08-14T15:26:31.376963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42887067794799805, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3baa-000c-dcd700185436"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_mae_faixa_etaria_mae__desconhecido.d11e899e97", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_mae\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.179148Z", "completed_at": "2025-08-14T15:26:31.202013Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.203323Z", "completed_at": "2025-08-14T15:26:31.579403Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.40706396102905273, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3a88-000c-dcd7001715e2"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_mae_sk_mae.c687c74418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_mae\nfrom HEALTH_INSIGHTS.marts.dim_mae\nwhere sk_mae is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.245597Z", "completed_at": "2025-08-14T15:26:31.265217Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.267096Z", "completed_at": "2025-08-14T15:26:31.584981Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3438138961791992, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3baa-000c-dcd70018543a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_mae_sk_mae.ba5d0f9bdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_mae as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_mae\nwhere sk_mae is not null\ngroup by sk_mae\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.322489Z", "completed_at": "2025-08-14T15:26:31.342520Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.344299Z", "completed_at": "2025-08-14T15:26:31.707528Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3885509967803955, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3c48-000c-dcd7001823ce"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_data_dia.fe310f51fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_dia\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere data_dia is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.613039Z", "completed_at": "2025-08-14T15:26:31.634952Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.658338Z", "completed_at": "2025-08-14T15:26:32.128762Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5241787433624268, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d36a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_tempo_sk_tempo.2def1c13e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_tempo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere sk_tempo is not null\ngroup by sk_tempo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.387877Z", "completed_at": "2025-08-14T15:26:31.408724Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.410432Z", "completed_at": "2025-08-14T15:26:32.133463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7498729228973389, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b8b-000c-dcd70017f366"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_sk_tempo.a5f54edc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_tempo\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere sk_tempo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:31.618340Z", "completed_at": "2025-08-14T15:26:31.633826Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:31.635986Z", "completed_at": "2025-08-14T15:26:34.672765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.066383123397827, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3a88-000c-dcd7001715e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.fato_nascimentos_enriquecido", "compiled": true, "compiled_code": "-- models/marts/fato_nascimentos_enriquecido.sql\n\n\nwith f as (\n  select * from HEALTH_INSIGHTS.silver.int_births_enriched\n)\nselect\n  f.*,\n  d.sk_localidade,\n  d.nome_municipio,\n  d.state_name\nfrom f\nleft join HEALTH_INSIGHTS.marts.dim_localidade d\n  on d.municipality_code = f.municipality_code", "relation_name": "HEALTH_INSIGHTS.marts.fato_nascimentos_enriquecido", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:32.149862Z", "completed_at": "2025-08-14T15:26:32.171324Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:32.172801Z", "completed_at": "2025-08-14T15:26:36.131378Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.985161066055298, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-39dd-000c-dcd70018619a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.fato_nascimentos", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    sk_birth,\n    birth_date,\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks,\n    delivery_type,\n    municipality_code,\n    -- categorias para link com dim_recem_nascido\n    case\n      when birth_weight_g is null then 'desconhecido'\n      when birth_weight_g < 2500   then 'baixo_peso'\n      when birth_weight_g >= 4000  then 'macrossomico'\n      else 'adequado'\n    end as categoria_peso,\n    case\n      when gestational_weeks is null then 'desconhecido'\n      when gestational_weeks < 37    then 'pre_termo'\n      when gestational_weeks between 37 and 41 then 'termo'\n      when gestational_weeks >= 42   then 'pos_termo'\n    end as categoria_gestacao\n  from HEALTH_INSIGHTS.silver.int_births_enriched\n  \n),\n\nlk_tempo as (\n  select sk_tempo, data_dia\n  from HEALTH_INSIGHTS.marts.dim_tempo\n),\n\nlk_localidade as (\n  select sk_localidade, municipality_code\n  from HEALTH_INSIGHTS.marts.dim_localidade\n),\n\nlk_recem as (\n  select sk_recem_nascido, sexo_bebe, categoria_peso, categoria_gestacao\n  from HEALTH_INSIGHTS.marts.dim_recem_nascido\n)\n\nselect\n  -- chaves\n  s.sk_birth,\n  t.sk_tempo            as fk_sk_tempo,\n  dloc.sk_localidade    as fk_sk_localidade,\n  drec.sk_recem_nascido as fk_sk_recem_nascido,\n\n  -- MEDIDAS / ATRIBUTOS para o dashboard\n  s.sex_newborn,\n  s.birth_weight_g,\n  s.gestational_weeks,\n  s.delivery_type\nfrom src s\nleft join lk_tempo      t    on s.birth_date = t.data_dia\nleft join lk_localidade dloc on s.municipality_code = dloc.municipality_code\nleft join lk_recem      drec\n       on drec.sexo_bebe = s.sex_newborn\n      and drec.categoria_peso = s.categoria_peso\n      and drec.categoria_gestacao = s.categoria_gestacao", "relation_name": "HEALTH_INSIGHTS.marts.fato_nascimentos", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.176858Z", "completed_at": "2025-08-14T15:26:36.222317Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.229649Z", "completed_at": "2025-08-14T15:26:36.620342Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.45998525619506836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3a88-000c-dcd7001715ea"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_fato_nascimentos_sk_birth.e98a446ce9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.marts.fato_nascimentos\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.185453Z", "completed_at": "2025-08-14T15:26:36.209572Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.211798Z", "completed_at": "2025-08-14T15:26:36.626258Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4641718864440918, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3a88-000c-dcd7001715ee"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_localidade__sk_localidade__ref_dim_localidade_.cee28b6216", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_localidade as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_localidade is not null\n),\n\nparent as (\n    select sk_localidade as to_field\n    from HEALTH_INSIGHTS.marts.dim_localidade\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.172246Z", "completed_at": "2025-08-14T15:26:36.215027Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.219002Z", "completed_at": "2025-08-14T15:26:36.706147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5476577281951904, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3abc-000c-dcd700176e16"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_fato_nascimentos_sex_newborn__M__F__U.4111c16aa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.193389Z", "completed_at": "2025-08-14T15:26:36.217845Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.223760Z", "completed_at": "2025-08-14T15:26:36.715642Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5516555309295654, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d36e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_recem_nascido__sk_recem_nascido__ref_dim_recem_nascido_.4bc6e8e0f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_recem_nascido as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_recem_nascido is not null\n),\n\nparent as (\n    select sk_recem_nascido as to_field\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.649381Z", "completed_at": "2025-08-14T15:26:36.679899Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.682494Z", "completed_at": "2025-08-14T15:26:37.103641Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.46135926246643066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d376"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_tempo__sk_tempo__ref_dim_tempo_.c417b97fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_tempo as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_tempo is not null\n),\n\nparent as (\n    select sk_tempo as to_field\n    from HEALTH_INSIGHTS.marts.dim_tempo\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:36.656812Z", "completed_at": "2025-08-14T15:26:36.672613Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:36.674931Z", "completed_at": "2025-08-14T15:26:37.110488Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.46607065200805664, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5dde-0306-3b99-000c-dcd70017d372"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_fato_nascimentos_sk_birth.987afa4974", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.fato_nascimentos\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:37.133715Z", "completed_at": "2025-08-14T15:26:37.158271Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:37.160797Z", "completed_at": "2025-08-14T15:26:37.550239Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4496290683746338, "adapter_response": {}, "message": "Database Error in model kpis_mensais (models/marts/kpis_mensais.sql)\n  000904 (42000): SQL compilation error: error line 12 at position 4\n  invalid identifier 'L.UF_SIGLA'\n  compiled code at target_snowflake/run/health_insights/models/marts/kpis_mensais.sql", "failures": null, "unique_id": "model.health_insights.kpis_mensais", "compiled": true, "compiled_code": "\n\nSELECT\n    t.ano,\n    t.mes,\n    l.uf_sigla,\n    COUNT(*) AS total_nasc,\n    COUNT_IF(gestacao_semanas < 37) / COUNT(*)::float AS taxa_prematuridade,\n    COUNT_IF(tipo_parto = 'cesariana') / COUNT(*)::float AS taxa_cesarianas,\n    COUNT_IF(peso < 2500) / COUNT(*)::float AS taxa_baixo_peso\nFROM HEALTH_INSIGHTS.marts.fato_nascimentos f\nJOIN HEALTH_INSIGHTS.marts.dim_tempo t ON f.fk_sk_tempo = t.sk_tempo\nJOIN HEALTH_INSIGHTS.marts.dim_localidade l ON f.fk_sk_localidade = l.sk_localidade\nGROUP BY t.ano, t.mes, l.uf_sigla", "relation_name": "HEALTH_INSIGHTS.marts.kpis_mensais", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-14T15:26:37.138820Z", "completed_at": "2025-08-14T15:26:37.152679Z"}, {"name": "execute", "started_at": "2025-08-14T15:26:37.154844Z", "completed_at": "2025-08-14T15:26:37.548156Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4497692584991455, "adapter_response": {}, "message": "Database Error in model quality_metrics (models/marts/quality_metrics.sql)\n  000904 (42000): SQL compilation error: error line 12 at position 13\n  invalid identifier 'BIRTH_DATE'\n  compiled code at target_snowflake/run/health_insights/models/marts/quality_metrics.sql", "failures": null, "unique_id": "model.health_insights.quality_metrics", "compiled": true, "compiled_code": "\n\nSELECT\n    CURRENT_TIMESTAMP AS verificado_em,\n    COUNT(*) AS total_registos,\n    COUNT_IF(birth_date IS NULL) AS nulos_birth_date,\n    COUNT_IF(fk_sk_localidade IS NULL) AS nulos_localidade,\n    COUNT(DISTINCT sk_nascimento) AS ids_unicos,\n    (COUNT(*) - COUNT(DISTINCT sk_nascimento)) AS duplicados\nFROM HEALTH_INSIGHTS.marts.fato_nascimentos", "relation_name": "HEALTH_INSIGHTS.marts.quality_metrics", "batch_results": null}], "elapsed_time": 26.687952756881714, "args": {"show": false, "state_modified_compare_vars": false, "strict_mode": false, "introspect": true, "which": "build", "profiles_dir": "/home/paula/.dbt", "partial_parse_file_diff": true, "log_path": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights/logs", "empty": false, "require_generic_test_arguments_property": false, "invocation_command": "dbt build --target snowflake --target-path target_snowflake", "cache_selected_only": false, "macro_debugging": false, "populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "validate_macro_args": false, "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "log_level_file": "debug", "print": true, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "version_check": true, "static_parser": true, "defer": false, "write_json": true, "exclude": [], "target": "snowflake", "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "quiet": false, "indirect_selection": "eager", "use_colors": true, "favor_state": false, "project_dir": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights", "require_explicit_package_overrides_for_builtin_materializations": true, "require_all_warnings_handled_by_warn_error": false, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "export_saved_queries": false, "upload_to_artifacts_ingest_api": false, "show_resource_report": false, "partial_parse": true, "select": [], "target_path": "target_snowflake", "use_fast_test_edges": false, "log_format": "default", "log_file_max_bytes": 10485760, "log_format_file": "debug", "exclude_resource_types": [], "include_saved_query": false, "printer_width": 80, "resource_types": [], "show_all_deprecations": false, "source_freshness_run_project_hooks": true}}