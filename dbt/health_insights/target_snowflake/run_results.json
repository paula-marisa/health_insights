{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-14T17:17:44.664487Z", "invocation_id": "0747ce8d-2878-41d3-8949-17394f902c3a", "invocation_started_at": "2025-08-14T17:16:35.566765Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:10.875139Z", "completed_at": "2025-08-14T17:17:11.493792Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:11.495560Z", "completed_at": "2025-08-14T17:17:12.434841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5705702304840088, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b99-000c-dcd70017d44e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.stg_births", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nwith src as (\n  select * from HEALTH_INSIGHTS.RAW_STG.sinasc_raw\n),\n\nk as (\n  \n  \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n    \n      \n        \n      \n    \n  \n\n  select\n    s.*,\n    row_number() over (\n      order by \n  \n    cast(DTNASC as varchar)\n  \n, \n  \n    cast(HORANASC as varchar)\n  \n, \n  \n    cast(CODESTAB as varchar)\n  \n, \n  \n    cast(CODMUNNASC as varchar)\n  \n, \n  \n    cast(SEXO as varchar)\n  \n, \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n, \n  \n    cast(DTRECEBIM as varchar)\n  \n, \n  \n    cast(DTCADASTRO as varchar)\n  \n, \n  \n    cast(NUMEROLOTE as varchar)\n  \n, \n  \n    cast(CONTADOR as varchar)\n  \n\n    ) as rn\n  from src s\n),\n\nnorm as (\n  select\n    -- usa CONTADOR/CODMUNNASC se existirem; caso contr\u00e1rio usa NULL para estabilizar o hash\n    md5(\n      coalesce( \n  \n    cast(CONTADOR as varchar)\n  \n , '') || '-' ||\n      coalesce( \n  \n    cast(CODMUNNASC as varchar)\n  \n , '') || '-' ||\n      lpad(\n  \n    cast(rn as varchar)\n  \n, 10, '0')\n    ) as sk_birth,\n\n    -- data de nascimento: v\u00e1rias formas\n    case\n      when \n  \n    regexp_like(\n  \n    cast(DTNASC as varchar)\n  \n, '^[0-9]{4}-[0-9]{2}-[0-9]{2}$')\n  \n then\n        \n  \n    \n      try_to_date(\n  \n    cast(DTNASC as varchar)\n  \n)\n    \n  \n\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{8}$')\n  \n then\n        coalesce(\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'DDMMYYYY')\n    \n  \n,\n          \n  \n    \n      try_to_date(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 'YYYYMMDD')\n    \n  \n\n        )\n      when \n  \n    regexp_like(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), '^[0-9]{7}$')\n  \n then\n        \n  \n    \n      try_to_date(lpad(regexp_replace(\n  \n    cast(DTNASC as varchar)\n  \n,'[^0-9]',''), 8, '0'), 'DDMMYYYY')\n    \n  \n\n      else null\n    end as birth_date,\n\n    case \n  \n    cast(SEXO as varchar)\n  \n\n      when '1' then 'M'\n      when '2' then 'F'\n      else 'U'\n    end as sex_newborn,\n\n             \n  -- int funciona em Snowflake e Spark\n  cast(PESO as int)\n        as birth_weight_g,\n         \n  \n    cast(GESTACAO as varchar)\n  \n    as gestation_code,\n       \n  -- int funciona em Snowflake e Spark\n  cast(SEMAGESTAC as int)\n  as gestational_weeks,\n            \n  \n    cast(PARTO as varchar)\n  \n       as delivery_type,\n       \n  \n    cast(CODMUNNASC as varchar)\n  \n  as municipality_code\n  from k\n)\n\nselect\n  sk_birth, birth_date, sex_newborn, birth_weight_g,\n  gestation_code, gestational_weeks, delivery_type, municipality_code,\n  \n  \n    to_char(birth_date, 'YYYY-MM')\n  \n as ym\nfrom norm\nwhere birth_date is not null", "relation_name": "HEALTH_INSIGHTS.raw_stg.stg_births", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:12.468715Z", "completed_at": "2025-08-14T17:17:12.504614Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:12.507581Z", "completed_at": "2025-08-14T17:17:14.503353Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.042405366897583, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b09-000c-dcd70017c5de"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_stg_births_sex_newborn__M__F__U.37e37a471e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.raw_stg.stg_births\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:12.482792Z", "completed_at": "2025-08-14T17:17:12.506285Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:12.530423Z", "completed_at": "2025-08-14T17:17:14.801949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.338512659072876, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd700182476"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_birth_date.6972dfbab3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect birth_date\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere birth_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:14.515019Z", "completed_at": "2025-08-14T17:17:14.534253Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:14.535800Z", "completed_at": "2025-08-14T17:17:16.367136Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8562684059143066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b8b-000c-dcd70017f442"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_stg_births_sk_birth.3de4ffc9db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:10.906239Z", "completed_at": "2025-08-14T17:17:10.906264Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:10.933475Z", "completed_at": "2025-08-14T17:17:16.395357Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.527663469314575, "adapter_response": {"_message": "INSERT 27", "code": "INSERT", "rows_affected": 27}, "message": "INSERT 27", "failures": null, "unique_id": "seed.health_insights.ref_uf", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:10.897282Z", "completed_at": "2025-08-14T17:17:10.897291Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:10.907890Z", "completed_at": "2025-08-14T17:17:16.397533Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.53131628036499, "adapter_response": {"_message": "INSERT 10", "code": "INSERT", "rows_affected": 10}, "message": "INSERT 10", "failures": null, "unique_id": "seed.health_insights.ref_municipios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:14.820263Z", "completed_at": "2025-08-14T17:17:14.844986Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:14.847515Z", "completed_at": "2025-08-14T17:17:16.427980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6130118370056152, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3ce3-000c-dcd700188182"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_stg_births_sk_birth.744376c997", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.raw_stg.stg_births\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:16.435252Z", "completed_at": "2025-08-14T17:17:16.462502Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:16.466921Z", "completed_at": "2025-08-14T17:17:17.054651Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6360862255096436, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b99-000c-dcd70017d45a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_uf_uf_sigla.28d0cf764d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect uf_sigla\nfrom HEALTH_INSIGHTS.RAW_STG.ref_uf\nwhere uf_sigla is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:16.447117Z", "completed_at": "2025-08-14T17:17:16.465679Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:16.479574Z", "completed_at": "2025-08-14T17:17:17.061419Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6382355690002441, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd700185516"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_ref_municipios_municipio_code.36fb7df381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipio_code\nfrom HEALTH_INSIGHTS.RAW_STG.ref_municipios\nwhere municipio_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:16.471045Z", "completed_at": "2025-08-14T17:17:16.503666Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:16.510811Z", "completed_at": "2025-08-14T17:17:17.139742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6789207458496094, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b99-000c-dcd70017d45e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_municipios_municipio_code.f1ab57dc22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipio_code as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG.ref_municipios\nwhere municipio_code is not null\ngroup by municipio_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:16.442211Z", "completed_at": "2025-08-14T17:17:16.464681Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:16.475273Z", "completed_at": "2025-08-14T17:17:17.143316Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7216167449951172, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd700185512"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_ref_uf_uf_sigla.f1ac44888d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    uf_sigla as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.RAW_STG.ref_uf\nwhere uf_sigla is not null\ngroup by uf_sigla\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:17.084872Z", "completed_at": "2025-08-14T17:17:17.104911Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:17.106363Z", "completed_at": "2025-08-14T17:17:18.507860Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.428149938583374, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3a88-000c-dcd7001716b6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.int_births_enriched", "compiled": true, "compiled_code": "\n\nwith s as (\n  select * from HEALTH_INSIGHTS.raw_stg.stg_births\n)\nselect\n  s.sk_birth,\n  s.municipality_code,\n  s.birth_date,\n  \n  \n    \n      try_to_date(concat(s.ym, '-01'))\n    \n  \n as year_month_date,\n  s.ym,\n\n  -- CAMPOS QUE A FATO PRECISA:\n  s.sex_newborn,\n  /* ajuste os nomes conforme existirem no teu stg_births */\n  s.birth_weight_g         as birth_weight_g,      -- se no stg for 'peso_nascimento_g', mapeia: s.peso_nascimento_g as birth_weight_g\n  s.gestational_weeks      as gestational_weeks,   -- idem ('semanas_gestacao' -> gestational_weeks)\n  s.delivery_type          as delivery_type,       -- idem ('tipo_parto' -> delivery_type)\n\n  -- outros campos \u00fateis\n  substr(cast(s.municipality_code as string), 1, 2) as state_code\nfrom s", "relation_name": "HEALTH_INSIGHTS.silver.int_births_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:17.157697Z", "completed_at": "2025-08-14T17:17:17.187868Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:17.189476Z", "completed_at": "2025-08-14T17:17:19.224902Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.071275234222412, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b8b-000c-dcd70017f446"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_localidade", "compiled": true, "compiled_code": "-- models/marts/dim/dim_localidade.sql\n\n\nwith muni as (\n  select\n    municipio_code,              -- vem do seed\n    uf_sigla       as state_code,\n    municipio_nome,\n    regiao\n  from HEALTH_INSIGHTS.RAW_STG.ref_municipios\n),\nufs as (\n  select\n    uf_sigla as state_code,\n    uf_nome  as state_name\n  from HEALTH_INSIGHTS.RAW_STG.ref_uf\n)\nselect\n  md5(cast(coalesce(cast(m.municipio_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as sk_localidade,\n  m.municipio_code  as municipality_code,\n  m.state_code,\n  u.state_name,\n  m.municipio_nome  as nome_municipio,\n  m.regiao\nfrom muni m\nleft join ufs u using (state_code)", "relation_name": "HEALTH_INSIGHTS.marts.dim_localidade", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:18.542043Z", "completed_at": "2025-08-14T17:17:18.567863Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:18.575185Z", "completed_at": "2025-08-14T17:17:21.529758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.003690481185913, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd70018247a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_mae", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT municipality_code, ym\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  -- port\u00e1til entre Snowflake e Databricks\n  md5(cast(coalesce(cast(municipality_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ym as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_mae,\n  CAST(NULL AS INT)                                                  AS idade_mae,      -- <- era NUMBER\n  'desconhecido'                                                     AS faixa_etaria_mae,\n  'desconhecido'                                                     AS escolaridade_mae\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.marts.dim_mae", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:18.536481Z", "completed_at": "2025-08-14T17:17:18.566200Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:18.569143Z", "completed_at": "2025-08-14T17:17:21.535784Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.011636257171631, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b8b-000c-dcd70017f44a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_faixa_etaria_sexo", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT DISTINCT\n    sex_newborn\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  md5(coalesce(sex_newborn,'') || '|desconhecido') AS sk_faixa_etaria_sexo,\n  'desconhecido'                                   AS faixa_etaria_mae,\n  sex_newborn                                      AS sexo_bebe\nFROM s", "relation_name": "HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:18.550155Z", "completed_at": "2025-08-14T17:17:18.573791Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:18.582144Z", "completed_at": "2025-08-14T17:17:21.540906Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.0128297805786133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-39dd-000c-dcd700186292"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_recem_nascido", "compiled": true, "compiled_code": "\n\nWITH s AS (\n  SELECT\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks\n  FROM HEALTH_INSIGHTS.silver.int_births_enriched\n)\nSELECT\n  md5(\n    coalesce(sex_newborn,'') || '|' ||\n    coalesce(\n      CASE\n        WHEN birth_weight_g IS NULL THEN 'desconhecido'\n        WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n        WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n        ELSE 'adequado'\n      END, ''\n    ) || '|' ||\n    coalesce(\n      CASE\n        WHEN gestational_weeks IS NULL THEN 'desconhecido'\n        WHEN gestational_weeks < 37    THEN 'pre_termo'\n        WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n        WHEN gestational_weeks >= 42   THEN 'pos_termo'\n      END, ''\n    )\n  )                                    AS sk_recem_nascido,\n  sex_newborn                           AS sexo_bebe,\n  CASE\n    WHEN birth_weight_g IS NULL THEN 'desconhecido'\n    WHEN birth_weight_g < 2500   THEN 'baixo_peso'\n    WHEN birth_weight_g >= 4000  THEN 'macrossomico'\n    ELSE 'adequado'\n  END                                   AS categoria_peso,\n  CASE\n    WHEN gestational_weeks IS NULL THEN 'desconhecido'\n    WHEN gestational_weeks < 37    THEN 'pre_termo'\n    WHEN gestational_weeks BETWEEN 37 AND 41 THEN 'termo'\n    WHEN gestational_weeks >= 42   THEN 'pos_termo'\n  END                                   AS categoria_gestacao\nFROM s\nGROUP BY 1,2,3,4", "relation_name": "HEALTH_INSIGHTS.marts.dim_recem_nascido", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:19.258156Z", "completed_at": "2025-08-14T17:17:19.287364Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:19.288648Z", "completed_at": "2025-08-14T17:17:21.899146Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.6463706493377686, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd70018247e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.dim_tempo", "compiled": true, "compiled_code": "\n\nwith d as (\n  select distinct \n  \n    cast(birth_date as date)\n  \n as data\n  from HEALTH_INSIGHTS.silver.int_births_enriched\n  where birth_date is not null\n)\nselect\n  md5(\n  \n    to_char(data, 'YYYY-MM-DD')\n  \n)      as sk_tempo,\n  data                                as data_dia,\n  year(data)                          as ano,\n  month(data)                         as mes,\n  \n  \n    to_char(data, 'YYYY-MM')\n  \n             as ym,\n  quarter(data)                       as trimestre,\n  \n  \n    dayofweekiso(data)\n  \n             as dia_semana_iso,\n  case when \n  \n    dayofweekiso(data)\n  \n in (6,7) then 1 else 0 end as is_fim_semana\nfrom d", "relation_name": "HEALTH_INSIGHTS.marts.dim_tempo", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:21.592358Z", "completed_at": "2025-08-14T17:17:21.614435Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:21.621652Z", "completed_at": "2025-08-14T17:17:22.094491Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5201780796051025, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3ce3-000c-dcd700188186"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_sk_localidade.4e64780a4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_localidade\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere sk_localidade is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:21.587815Z", "completed_at": "2025-08-14T17:17:21.609148Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:21.616122Z", "completed_at": "2025-08-14T17:17:22.102057Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5292379856109619, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd70018551a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_nome_municipio.308dae2d1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nome_municipio\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere nome_municipio is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:21.581350Z", "completed_at": "2025-08-14T17:17:21.608320Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:21.610946Z", "completed_at": "2025-08-14T17:17:22.294269Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7228870391845703, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3a88-000c-dcd7001716ba"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_municipality_code.c333a34ef4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect municipality_code\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere municipality_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:21.926063Z", "completed_at": "2025-08-14T17:17:21.945640Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:21.947242Z", "completed_at": "2025-08-14T17:17:22.366739Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4462859630584717, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd700182482"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_localidade_state_code.c73ddb8f97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.140127Z", "completed_at": "2025-08-14T17:17:22.159984Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.162628Z", "completed_at": "2025-08-14T17:17:22.587559Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.46004819869995117, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3ce3-000c-dcd70018818a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_sk_localidade.9a9ecd5e89", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_localidade as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere sk_localidade is not null\ngroup by sk_localidade\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.133547Z", "completed_at": "2025-08-14T17:17:22.153968Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.155709Z", "completed_at": "2025-08-14T17:17:22.661779Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5363547801971436, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-39dd-000c-dcd700186296"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_localidade_municipality_code.fc817a75fb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    municipality_code as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_localidade\nwhere municipality_code is not null\ngroup by municipality_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.305554Z", "completed_at": "2025-08-14T17:17:22.327012Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.328611Z", "completed_at": "2025-08-14T17:17:22.760099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4583313465118408, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b8b-000c-dcd70017f44e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_mae_faixa_etaria_mae__desconhecido.d11e899e97", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_mae\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.377398Z", "completed_at": "2025-08-14T17:17:22.394371Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.396528Z", "completed_at": "2025-08-14T17:17:22.829086Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4549522399902344, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3a88-000c-dcd7001716be"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_mae_sk_mae.c687c74418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_mae\nfrom HEALTH_INSIGHTS.marts.dim_mae\nwhere sk_mae is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.600449Z", "completed_at": "2025-08-14T17:17:22.619910Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.621634Z", "completed_at": "2025-08-14T17:17:23.040232Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4440619945526123, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-39dd-000c-dcd70018629a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_mae_sk_mae.ba5d0f9bdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_mae as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_mae\nwhere sk_mae is not null\ngroup by sk_mae\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.841616Z", "completed_at": "2025-08-14T17:17:22.863569Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.865196Z", "completed_at": "2025-08-14T17:17:23.440357Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6031804084777832, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd70018551e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.852c7b558e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_faixa_etaria_sexo\nfrom HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.672689Z", "completed_at": "2025-08-14T17:17:22.694691Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.696410Z", "completed_at": "2025-08-14T17:17:23.443816Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7748804092407227, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3abc-000c-dcd700176efe"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_faixa_etaria_mae__desconhecido.c2da527898", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        faixa_etaria_mae as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\n    group by faixa_etaria_mae\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:22.771825Z", "completed_at": "2025-08-14T17:17:22.793957Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:22.795653Z", "completed_at": "2025-08-14T17:17:23.447247Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6799478530883789, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-39dd-000c-dcd70018629e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_faixa_etaria_sexo_sexo_bebe__M__F__U.362c430907", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:23.058120Z", "completed_at": "2025-08-14T17:17:23.083030Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:23.084716Z", "completed_at": "2025-08-14T17:17:23.471791Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4188578128814697, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd700182486"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_faixa_etaria_sexo_sk_faixa_etaria_sexo.b936648aef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_faixa_etaria_sexo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_faixa_etaria_sexo\nwhere sk_faixa_etaria_sexo is not null\ngroup by sk_faixa_etaria_sexo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:23.501633Z", "completed_at": "2025-08-14T17:17:23.529088Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:23.538453Z", "completed_at": "2025-08-14T17:17:23.953510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47748589515686035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd700185526"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_sexo_bebe__M__F__U.5134deaa4d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sexo_bebe as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by sexo_bebe\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:23.484285Z", "completed_at": "2025-08-14T17:17:23.519572Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:23.526257Z", "completed_at": "2025-08-14T17:17:23.957048Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4886507987976074, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd700185522"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_gestacao__pre_termo__termo__pos_termo__desconhecido.1c35f10411", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_gestacao as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by categoria_gestacao\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pre_termo','termo','pos_termo','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:23.493949Z", "completed_at": "2025-08-14T17:17:23.524779Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:23.531688Z", "completed_at": "2025-08-14T17:17:23.961521Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.48743104934692383, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd70018552e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_dim_recem_nascido_categoria_peso__baixo_peso__adequado__macrossomico__desconhecido.5ffeee162e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        categoria_peso as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n    group by categoria_peso\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'baixo_peso','adequado','macrossomico','desconhecido'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:23.520762Z", "completed_at": "2025-08-14T17:17:23.545884Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:23.547537Z", "completed_at": "2025-08-14T17:17:23.965778Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4494476318359375, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd70018552a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_recem_nascido_sk_recem_nascido.ad02f86bcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_recem_nascido\nfrom HEALTH_INSIGHTS.marts.dim_recem_nascido\nwhere sk_recem_nascido is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.023980Z", "completed_at": "2025-08-14T17:17:24.038535Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.042918Z", "completed_at": "2025-08-14T17:17:24.506421Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5091025829315186, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3ce3-000c-dcd70018818e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_tempo_sk_tempo.2def1c13e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_tempo as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere sk_tempo is not null\ngroup by sk_tempo\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.011743Z", "completed_at": "2025-08-14T17:17:24.046075Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.055233Z", "completed_at": "2025-08-14T17:17:24.514264Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5201404094696045, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-39dd-000c-dcd7001862a2"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_data_dia.fe310f51fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_dia\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere data_dia is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.016541Z", "completed_at": "2025-08-14T17:17:24.041838Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.050551Z", "completed_at": "2025-08-14T17:17:24.522718Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5270640850067139, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3a88-000c-dcd7001716c2"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_dim_tempo_sk_tempo.a5f54edc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_tempo\nfrom HEALTH_INSIGHTS.marts.dim_tempo\nwhere sk_tempo is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.004846Z", "completed_at": "2025-08-14T17:17:24.040436Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.047416Z", "completed_at": "2025-08-14T17:17:24.635169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6430892944335938, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b09-000c-dcd70017c5e6"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_dim_recem_nascido_sk_recem_nascido.91c6374a3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_recem_nascido as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.dim_recem_nascido\nwhere sk_recem_nascido is not null\ngroup by sk_recem_nascido\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.645032Z", "completed_at": "2025-08-14T17:17:24.672203Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.673552Z", "completed_at": "2025-08-14T17:17:37.099324Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 12.45753812789917, "adapter_response": {"_message": "SUCCESS 292", "code": "SUCCESS", "rows_affected": 292, "query_id": "01be5e4d-0306-3b09-000c-dcd70017c5ee"}, "message": "SUCCESS 292", "failures": null, "unique_id": "model.health_insights.fato_nascimentos", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    sk_birth,\n    birth_date,\n    sex_newborn,\n    birth_weight_g,\n    gestational_weeks,\n    delivery_type,\n    municipality_code,\n    -- categorias para link com dim_recem_nascido\n    case\n      when birth_weight_g is null then 'desconhecido'\n      when birth_weight_g < 2500   then 'baixo_peso'\n      when birth_weight_g >= 4000  then 'macrossomico'\n      else 'adequado'\n    end as categoria_peso,\n    case\n      when gestational_weeks is null then 'desconhecido'\n      when gestational_weeks < 37    then 'pre_termo'\n      when gestational_weeks between 37 and 41 then 'termo'\n      when gestational_weeks >= 42   then 'pos_termo'\n    end as categoria_gestacao\n  from HEALTH_INSIGHTS.silver.int_births_enriched\n  \n    where birth_date >= (\n      select coalesce(max(t.data_dia),'1900-01-01'::date)\n      from HEALTH_INSIGHTS.marts.fato_nascimentos f\n      join HEALTH_INSIGHTS.marts.dim_tempo t on f.fk_sk_tempo = t.sk_tempo\n    )\n  \n),\n\nlk_tempo as (\n  select sk_tempo, data_dia\n  from HEALTH_INSIGHTS.marts.dim_tempo\n),\n\nlk_localidade as (\n  select sk_localidade, municipality_code\n  from HEALTH_INSIGHTS.marts.dim_localidade\n),\n\nlk_recem as (\n  select sk_recem_nascido, sexo_bebe, categoria_peso, categoria_gestacao\n  from HEALTH_INSIGHTS.marts.dim_recem_nascido\n)\n\nselect\n  -- chaves\n  s.sk_birth,\n  t.sk_tempo            as fk_sk_tempo,\n  dloc.sk_localidade    as fk_sk_localidade,\n  drec.sk_recem_nascido as fk_sk_recem_nascido,\n\n  -- MEDIDAS / ATRIBUTOS para o dashboard\n  s.sex_newborn,\n  s.birth_weight_g,\n  s.gestational_weeks,\n  s.delivery_type\nfrom src s\nleft join lk_tempo      t    on s.birth_date = t.data_dia\nleft join lk_localidade dloc on s.municipality_code = dloc.municipality_code\nleft join lk_recem      drec\n       on drec.sexo_bebe = s.sex_newborn\n      and drec.categoria_peso = s.categoria_peso\n      and drec.categoria_gestacao = s.categoria_gestacao", "relation_name": "HEALTH_INSIGHTS.marts.fato_nascimentos", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.143304Z", "completed_at": "2025-08-14T17:17:37.177397Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.183138Z", "completed_at": "2025-08-14T17:17:37.536541Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4082605838775635, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b09-000c-dcd70017c5f6"}, "message": null, "failures": 0, "unique_id": "test.health_insights.not_null_fato_nascimentos_sk_birth.e98a446ce9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sk_birth\nfrom HEALTH_INSIGHTS.marts.fato_nascimentos\nwhere sk_birth is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.137224Z", "completed_at": "2025-08-14T17:17:37.171941Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.178736Z", "completed_at": "2025-08-14T17:17:37.553116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42755913734436035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b09-000c-dcd70017c5fa"}, "message": null, "failures": 0, "unique_id": "test.health_insights.accepted_values_fato_nascimentos_sex_newborn__M__F__U.4111c16aa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex_newborn as value_field,\n        count(*) as n_records\n\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    group by sex_newborn\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F','U'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.150231Z", "completed_at": "2025-08-14T17:17:37.171094Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.173126Z", "completed_at": "2025-08-14T17:17:37.564161Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4336726665496826, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd70018248e"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_localidade__sk_localidade__ref_dim_localidade_.cee28b6216", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_localidade as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_localidade is not null\n),\n\nparent as (\n    select sk_localidade as to_field\n    from HEALTH_INSIGHTS.marts.dim_localidade\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.599797Z", "completed_at": "2025-08-14T17:17:37.621826Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.624362Z", "completed_at": "2025-08-14T17:17:38.208222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6244404315948486, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b99-000c-dcd70017d46a"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_tempo__sk_tempo__ref_dim_tempo_.c417b97fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_tempo as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_tempo is not null\n),\n\nparent as (\n    select sk_tempo as to_field\n    from HEALTH_INSIGHTS.marts.dim_tempo\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.607945Z", "completed_at": "2025-08-14T17:17:37.627737Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.630597Z", "completed_at": "2025-08-14T17:17:38.211557Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.619084358215332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3baa-000c-dcd700185536"}, "message": null, "failures": 0, "unique_id": "test.health_insights.unique_fato_nascimentos_sk_birth.987afa4974", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sk_birth as unique_field,\n    count(*) as n_records\n\nfrom HEALTH_INSIGHTS.marts.fato_nascimentos\nwhere sk_birth is not null\ngroup by sk_birth\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:24.544574Z", "completed_at": "2025-08-14T17:17:24.565625Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:24.567624Z", "completed_at": "2025-08-14T17:17:38.216252Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 13.6750807762146, "adapter_response": {"_message": "SUCCESS 356514", "code": "SUCCESS", "rows_affected": 356514, "query_id": "01be5e4d-0306-3a88-000c-dcd7001716de"}, "message": "SUCCESS 356514", "failures": null, "unique_id": "model.health_insights.fato_nascimentos_enriquecido", "compiled": true, "compiled_code": "-- models/marts/fato_nascimentos_enriquecido.sql\n\n\nwith f as (\n  select * from HEALTH_INSIGHTS.silver.int_births_enriched\n)\nselect\n  f.*,\n  d.sk_localidade,\n  d.nome_municipio,\n  d.state_name\nfrom f\nleft join HEALTH_INSIGHTS.marts.dim_localidade d\n  on d.municipality_code = f.municipality_code", "relation_name": "HEALTH_INSIGHTS.marts.fato_nascimentos_enriquecido", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:37.585583Z", "completed_at": "2025-08-14T17:17:37.615309Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:37.617558Z", "completed_at": "2025-08-14T17:17:38.432243Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8571000099182129, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3b8b-000c-dcd70017f456"}, "message": null, "failures": 0, "unique_id": "test.health_insights.relationships_fato_nascimentos_fk_sk_recem_nascido__sk_recem_nascido__ref_dim_recem_nascido_.4bc6e8e0f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select fk_sk_recem_nascido as from_field\n    from HEALTH_INSIGHTS.marts.fato_nascimentos\n    where fk_sk_recem_nascido is not null\n),\n\nparent as (\n    select sk_recem_nascido as to_field\n    from HEALTH_INSIGHTS.marts.dim_recem_nascido\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:38.455844Z", "completed_at": "2025-08-14T17:17:38.477647Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:38.479720Z", "completed_at": "2025-08-14T17:17:39.031193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5850527286529541, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3abc-000c-dcd700176f02"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.kpis_mensais", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM HEALTH_INSIGHTS.marts.fato_nascimentos\n),\nt AS (\n  SELECT sk_tempo, \n  \n    to_char(data_dia, 'YYYY-MM')\n  \n AS ym\n  FROM HEALTH_INSIGHTS.marts.dim_tempo\n),\nl AS (\n  SELECT sk_localidade, state_code, state_name\n  FROM HEALTH_INSIGHTS.marts.dim_localidade\n)\nSELECT\n  t.ym,\n  l.state_code,\n  COUNT(*) AS total_nascimentos,\n  AVG(CASE WHEN UPPER(f.delivery_type) IN ('C','CESAREA','CES\u00c1REA') THEN 1 ELSE 0 END) AS pct_cesarianas\nFROM f\nJOIN t ON f.fk_sk_tempo = t.sk_tempo\nJOIN l ON f.fk_sk_localidade = l.sk_localidade\nGROUP BY 1,2", "relation_name": "HEALTH_INSIGHTS.marts.kpis_mensais", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-14T17:17:38.463169Z", "completed_at": "2025-08-14T17:17:38.485406Z"}, {"name": "execute", "started_at": "2025-08-14T17:17:38.495067Z", "completed_at": "2025-08-14T17:17:39.559440Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1110830307006836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be5e4d-0306-3c48-000c-dcd700182492"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.health_insights.quality_metrics", "compiled": true, "compiled_code": "\n\nWITH f AS (\n  SELECT * FROM HEALTH_INSIGHTS.marts.fato_nascimentos\n),\nt AS (\n  SELECT sk_tempo, data_dia\n  FROM HEALTH_INSIGHTS.marts.dim_tempo\n)\nSELECT\n  t.data_dia AS birth_date,\n  \n  \n    to_char(t.data_dia, 'YYYY-MM')\n  \n AS ym,\n  COUNT(*) AS n_registos,\n  AVG(CASE WHEN f.birth_weight_g    IS NULL THEN 1 ELSE 0 END) AS pct_sem_peso,\n  AVG(CASE WHEN f.gestational_weeks IS NULL THEN 1 ELSE 0 END) AS pct_sem_gestacao\nFROM f\nLEFT JOIN t ON f.fk_sk_tempo = t.sk_tempo\nGROUP BY 1,2", "relation_name": "HEALTH_INSIGHTS.marts.quality_metrics", "batch_results": null}], "elapsed_time": 41.233595848083496, "args": {"project_dir": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights", "select": [], "invocation_command": "dbt build --target snowflake --target-path target_snowflake", "partial_parse": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_format": "default", "send_anonymous_usage_stats": true, "use_colors": true, "quiet": false, "resource_types": [], "log_format_file": "debug", "target_path": "target_snowflake", "which": "build", "version_check": true, "require_generic_test_arguments_property": false, "cache_selected_only": false, "populate_cache": true, "log_level": "info", "show": false, "macro_debugging": false, "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "export_saved_queries": false, "strict_mode": false, "favor_state": false, "defer": false, "require_resource_names_without_spaces": true, "upload_to_artifacts_ingest_api": false, "introspect": true, "vars": {}, "write_json": true, "printer_width": 80, "show_resource_report": false, "state_modified_compare_vars": false, "exclude": [], "require_nested_cumulative_type_params": false, "exclude_resource_types": [], "profiles_dir": "/home/paula/.dbt", "log_file_max_bytes": 10485760, "require_batched_execution_for_custom_microbatch_strategy": false, "indirect_selection": "eager", "use_fast_test_edges": false, "require_yaml_configuration_for_mf_time_spines": false, "show_all_deprecations": false, "log_path": "/mnt/c/Users/paula/Desktop/Triggo.ai/Projecto/health_insights/dbt/health_insights/logs", "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "validate_macro_args": false, "empty": false, "print": true, "include_saved_query": false, "log_level_file": "debug", "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "target": "snowflake", "use_colors_file": true, "require_all_warnings_handled_by_warn_error": false}}